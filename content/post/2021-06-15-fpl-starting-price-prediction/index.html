---
title: FPL Starting Price Prediction
author: ''
date: '2021-06-15'
slug: []
categories: []
tags:
  - data modelling
description: ''
topics: []
---

<script src="index_files/header-attrs/header-attrs.js"></script>
<link href="index_files/anchor-sections/anchor-sections.css" rel="stylesheet" />
<script src="index_files/anchor-sections/anchor-sections.js"></script>
<script src="index_files/kePrint/kePrint.js"></script>
<link href="index_files/lightable/lightable.css" rel="stylesheet" />
<link href="index_files/bsTable/bootstrapTable.min.css" rel="stylesheet" />
<script src="index_files/bsTable/bootstrapTable.js"></script>
<script src="index_files/htmlwidgets/htmlwidgets.js"></script>
<script src="index_files/jquery/jquery.min.js"></script>
<link href="index_files/datatables-css/datatables-crosstalk.css" rel="stylesheet" />
<script src="index_files/datatables-binding/datatables.js"></script>
<link href="index_files/dt-core/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="index_files/dt-core/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="index_files/dt-core/js/jquery.dataTables.min.js"></script>
<link href="index_files/nouislider/jquery.nouislider.min.css" rel="stylesheet" />
<script src="index_files/nouislider/jquery.nouislider.min.js"></script>
<link href="index_files/selectize/selectize.bootstrap3.css" rel="stylesheet" />
<script src="index_files/selectize/selectize.min.js"></script>
<link href="index_files/crosstalk/css/crosstalk.css" rel="stylesheet" />
<script src="index_files/crosstalk/js/crosstalk.min.js"></script>


<p>As of this post being written the 2020/21 season of FPL has concluded and the 2021/22 season has yet to be started. Since the 2021/22 hasn’t started this means that the prices for the players for next season haven’t been released. So I thought this would be a good opportunity to use some machine learning algorithms to predict the next seasons starting price for a player.</p>
<p>First, we will need to collect the data and there is an excellent repo on github that contains data from the past seasons of FPL. This link to the repo is <a href="https://github.com/vaastav/Fantasy-Premier-League">here</a>.</p>
<p>After obtaining the data we will implement a machine learning algorithm to predict the next season player prices and see how different variables affect the price and any insight we can see.</p>
<div id="obtaining-the-data" class="section level1">
<h1>Obtaining the data</h1>
<p>Here we will obtain the data and clean it.</p>
<p>This is the raw data</p>
<pre class="r"><code>library(tidyverse)
options(kableExtra.html.bsTable = TRUE) # For kable table

raw_FPL2017 &lt;-  read_csv(&quot;https://raw.githubusercontent.com/vaastav/Fantasy-Premier-League/master/data/2017-18/players_raw.csv&quot;)
raw_FPL2018 &lt;-  read_csv(&quot;https://raw.githubusercontent.com/vaastav/Fantasy-Premier-League/master/data/2018-19/players_raw.csv&quot;)
raw_FPL2019 &lt;-  read_csv(&quot;https://raw.githubusercontent.com/vaastav/Fantasy-Premier-League/master/data/2019-20/players_raw.csv&quot;)
raw_FPL2020 &lt;-  read_csv(&quot;https://raw.githubusercontent.com/vaastav/Fantasy-Premier-League/master/data/2020-21/players_raw.csv&quot;)</code></pre>
<p>We will need to clean it and change it into a form that is useful for us.</p>
<pre class="r"><code>clean_df &lt;- function(df){
  
  # Function that takes in a dataframe and cleans it
  #
  #  Inputs : df  - a Dataframe
  #  Output : f_df - a cleaned Dataframe of df
  f_df &lt;-  df %&gt;% 
      select(id,first_name,second_name,element_type,team,total_points,minutes,now_cost,cost_change_start,points_per_game,selected_by_percent,transfers_in,transfers_out,value_season) %&gt;% 
    mutate( final_cost = now_cost/10,
            cost_change_start = cost_change_start/10,
            start_cost = final_cost - cost_change_start) %&gt;% 
    select(-now_cost) %&gt;% 
    unite(&quot;full_name&quot;,  first_name:second_name, sep=&quot; &quot; ) %&gt;% 
    mutate( full_name = str_to_lower(full_name) ) %&gt;% 
    mutate( full_name =  str_replace_all(full_name,&quot;-&quot;,&quot; &quot;) ) %&gt;% 
    mutate( element_type =  case_when( element_type == 1 ~ &quot;GK&quot;,
                                       element_type == 2 ~ &quot;DEF&quot;,
                                       element_type == 3 ~ &quot;MID&quot;,
                                       element_type == 4 ~ &quot;FWD&quot;) ) %&gt;% 
    mutate( element_type = factor(element_type,levels=c(&quot;GK&quot;,&quot;DEF&quot;,&quot;MID&quot;,&quot;FWD&quot;) ))
  
  return(f_df)
}</code></pre>
<p>The next function is used to obtain the next season’s prices for a given season</p>
<pre class="r"><code>cleaning_further &lt;- function(df1,df2,remove_na=TRUE){
  
  # Function that obtains the cleaned version of a current season and joints the next season prices
  #
  # Inputs: df1 - current season of FPL
  #         df2 - the next season of FPL - used to get next season starting prices
  #     remove_na - use na.omit() on data, default is TRUE
  #
  # Output: cleaned - a dataframe that is the cleaned version of df1 and has season starting prices from df2
    next_cost &lt;-  clean_df(df2) %&gt;% 
      select(full_name,next_season_cost=start_cost)
    
    cleaned &lt;-  clean_df(df1) %&gt;% 
      left_join(next_cost,by=c(&quot;full_name&quot;)) %&gt;% 
      relocate( start_cost, .before = final_cost )
    
    if (remove_na){ cleaned &lt;-  cleaned %&gt;% na.omit() }
    return(cleaned)
}</code></pre>
<p>Now with the framework of our cleaning, let’s actually clean the data.</p>
<pre class="r"><code># We remove the following players as they would cause problems in our clean data set
# as they share the same name as other players how have feature more in our data
# These players are from from relegated teams

raw_FPL2018 &lt;- raw_FPL2018 %&gt;% filter(id != 105 )
raw_FPL2020 &lt;- raw_FPL2020 %&gt;% filter(id != 653 )

clean_2017 &lt;-  cleaning_further(raw_FPL2017,raw_FPL2018,remove_na = FALSE)
# This following player had a name change
clean_2017$next_season_cost[clean_2017$full_name==&quot;damian emiliano martinez&quot;]  &lt;- 4.0
clean_2017 &lt;-  clean_2017  %&gt;%  na.omit() 

clean_2018 &lt;- cleaning_further(raw_FPL2018, raw_FPL2019 )
clean_2019 &lt;- cleaning_further(raw_FPL2019, raw_FPL2020 ) 

full_clean &lt;- bind_rows(clean_2017, clean_2018, clean_2019) 

glimpse(full_clean)</code></pre>
<pre><code>## Rows: 1,297
## Columns: 15
## $ id                  &lt;dbl&gt; 2, 3, 4, 7, 9, 10, 11, 12, 13, 16, 18, 21, 22, 23,~
## $ full_name           &lt;chr&gt; &quot;petr cech&quot;, &quot;damian emiliano martinez&quot;, &quot;laurent ~
## $ element_type        &lt;fct&gt; GK, GK, DEF, DEF, DEF, DEF, DEF, DEF, DEF, MID, MI~
## $ team                &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,~
## $ total_points        &lt;dbl&gt; 124, 0, 100, 132, 0, 130, 27, 109, 108, 112, 130, ~
## $ minutes             &lt;dbl&gt; 3039, 0, 2225, 3050, 0, 2241, 819, 2272, 2146, 216~
## $ cost_change_start   &lt;dbl&gt; -0.2, 0.0, 0.0, -0.1, 0.0, 0.2, -0.6, -0.1, -0.2, ~
## $ points_per_game     &lt;dbl&gt; 3.6, 0.0, 4.0, 3.8, 0.0, 4.6, 2.3, 4.0, 4.0, 4.3, ~
## $ selected_by_percent &lt;dbl&gt; 4.5, 0.6, 1.5, 10.3, 0.2, 8.0, 0.7, 4.2, 6.1, 2.1,~
## $ transfers_in        &lt;dbl&gt; 183262, 1506, 205878, 748052, 751, 1603695, 29403,~
## $ transfers_out       &lt;dbl&gt; 294471, 29335, 199153, 960552, 13677, 1476893, 111~
## $ value_season        &lt;dbl&gt; 23.4, 0.0, 16.7, 22.4, 0.0, 22.8, 6.1, 20.2, 18.6,~
## $ start_cost          &lt;dbl&gt; 5.5, 4.0, 6.0, 6.0, 4.5, 5.5, 5.0, 5.5, 6.0, 9.5, ~
## $ final_cost          &lt;dbl&gt; 5.3, 4.0, 6.0, 5.9, 4.5, 5.7, 4.4, 5.4, 5.8, 9.3, ~
## $ next_season_cost    &lt;dbl&gt; 5.0, 4.0, 5.5, 5.5, 4.5, 5.5, 4.5, 5.5, 5.0, 8.5, ~</code></pre>
<p>And with that we have obtained our data!</p>
</div>
<div id="model-creation" class="section level1">
<h1>Model Creation</h1>
<p>Now with our dataset created, lets create a model using <code>tidymodels</code>!</p>
<p>First we will split the data into a train and test set</p>
<pre class="r"><code>library(tidymodels)

set.seed(2021)
fpl_split &lt;-  initial_split(full_clean,strata = next_season_cost )

fpl_train = training(fpl_split)
fpl_test = testing(fpl_split)

set.seed(2021)
# We will use 10 fold cross validation
folds &lt;-  vfold_cv(fpl_train,v=10)</code></pre>
<p>After some testing and playing around with the model earlier, I found that a linear regression model works best, even up against glm models that used various hyperparamters and against tuned random forests too.</p>
<pre class="r"><code>lm_mod &lt;- recipe( next_season_cost ~ start_cost + cost_change_start +  element_type + total_points + minutes + transfers_in + transfers_out +
                    selected_by_percent +  points_per_game +  value_season, data= fpl_train  ) %&gt;% 
  step_dummy(all_nominal_predictors())

lm_spec &lt;-linear_reg() %&gt;%
  set_engine(&#39;lm&#39;) %&gt;% 
  set_mode(&quot;regression&quot;)

lm_wf &lt;-  workflow() %&gt;% 
  add_model(lm_spec) %&gt;% 
  add_recipe(lm_mod)

lm_fit_rs &lt;-  lm_wf %&gt;% 
  fit_resamples(folds)

lm_fit_rs %&gt;% collect_metrics() </code></pre>
<pre><code>## # A tibble: 2 x 6
##   .metric .estimator  mean     n std_err .config             
##   &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;               
## 1 rmse    standard   0.332    10 0.0144  Preprocessor1_Model1
## 2 rsq     standard   0.928    10 0.00673 Preprocessor1_Model1</code></pre>
<p>Using cross validation, we get an average rmse score of 0.33, this means that on average the model’s error is about £0.33m off. Not bad for a simple model!</p>
<p>Let’s see how the model performs on the holdout set</p>
<pre class="r"><code>test_pred &lt;- lm_wf %&gt;% fit(fpl_train) %&gt;% 
  predict(new_data = fpl_test) %&gt;% 
    bind_cols( fpl_test , . )
  
test_pred %&gt;% 
  rmse(truth = next_season_cost,estimate = .pred )</code></pre>
<pre><code>## # A tibble: 1 x 3
##   .metric .estimator .estimate
##   &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;
## 1 rmse    standard       0.340</code></pre>
<p>The rmse on the holdout set was 0.34 - very close to the training set’s rmse. and we would expect the testing set to have a slightly higher rmse.</p>
<p>One thing to note is that all player prices are rounded to the nearest £0.5m at the start of a season, eg if player is £8.61m, it would be rounded to £8.5m. Let’s see the rmse for the rounded predictions</p>
<pre class="r"><code>test_pred %&gt;% 
  mutate(  round_pred = round(.pred/0.5)*0.5 ) %&gt;% 
  rmse(truth = next_season_cost,estimate = round_pred )</code></pre>
<pre><code>## # A tibble: 1 x 3
##   .metric .estimator .estimate
##   &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;
## 1 rmse    standard       0.375</code></pre>
<p>We get an rmse that’s very close to the unrounded prices.</p>
<p>Let’s plot the the predicted prices against the true prices.</p>
<pre class="r"><code>test_pred %&gt;% 
  ggplot(aes(x=.pred,y=next_season_cost)) +
  geom_point(size=2,col=&quot;black&quot;) +
  geom_abline(slope=1,lty=2,col=&quot;blue&quot;)+
  geom_smooth(method=&quot;loess&quot;,col=&quot;red&quot;)+
  labs(title=&quot;Predicted vs actual values of starting price on the test set&quot;,
       subtitle=&quot;Dashed line represents line of best fit, red line represent model&#39;s general fit&quot;,
       x=&quot;Predicted Price&quot;,y=&quot;Actual Price&quot;) +
  scale_x_continuous(labels = scales::label_dollar(prefix = &quot;£&quot;,suffix = &quot;m&quot;),breaks = seq(4,12,1))+
  scale_y_continuous(labels = scales::label_dollar(prefix = &quot;£&quot;,suffix = &quot;m&quot;),breaks = seq(4,12,1))+
  theme_light()+
  theme(plot.title.position = &quot;plot&quot;)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>We see that largely speaking we get quite good results overall. Let’s try to see if a player’s position may affects the model’s performance.</p>
<pre class="r"><code>test_pred %&gt;% 
  ggplot(aes(x=.pred,y=next_season_cost,col=element_type)) +
  geom_point(size=2,show.legend = FALSE)+
  facet_wrap(.~element_type,scales = &quot;free&quot;)+
  geom_abline(slope=1,lty=2,col=&quot;black&quot;)+
  geom_smooth(method=&quot;loess&quot;,col=&quot;black&quot;)+
  scale_color_brewer(palette=&quot;Set1&quot;)+
  labs(title=&quot;Predicted vs actual values of starting price on the test set by player position&quot;,
       subtitle=&quot;Dashed line represents line of best fit, thick line represent model&#39;s general fit&quot;,
       x=&quot;Predicted Price&quot;,y=&quot;Actual Price&quot;) +
  scale_x_continuous(labels = scales::label_dollar(prefix = &quot;£&quot;,suffix = &quot;m&quot;))+
  scale_y_continuous(labels = scales::label_dollar(prefix = &quot;£&quot;,suffix = &quot;m&quot;))+
  theme_bw()+
  theme(plot.title.position = &quot;plot&quot;)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>We see what is happening! Our model is doing very well on midfielders and forwards, however our model is overestimating expensive players that play as goalkeepers or defenders. Perhaps a better method would be create a model for each position? That way we can incorporate important attributes for defensive players likes cleansheets, saves and goals conceded.</p>
<p>While we are looking at the different positions, let’s see how the rmse varies with position.</p>
<pre class="r"><code>test_pred %&gt;% 
  group_by(element_type) %&gt;% 
  rmse(truth = next_season_cost,estimate=.pred)  </code></pre>
<pre><code>## # A tibble: 4 x 4
##   element_type .metric .estimator .estimate
##   &lt;fct&gt;        &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;
## 1 GK           rmse    standard       0.318
## 2 DEF          rmse    standard       0.284
## 3 MID          rmse    standard       0.332
## 4 FWD          rmse    standard       0.485</code></pre>
<p>We see that goalkeepers and defenders tend to have good rmse values, while the mid has an rmse that is slightly worse. Forwards have an price error of nearly £0.5m!</p>
<p>Let’s now fit the data to the entire dataset available and explore what the coefficients conclude.</p>
</div>
<div id="the-model" class="section level1">
<h1>The model</h1>
<p>We fit the model on our train + test set (which was <code>full_clean</code>)</p>
<pre class="r"><code>full_model &lt;-  lm_wf %&gt;%  fit(full_clean)</code></pre>
<p>Let’s see what the coefficients tell us. Note that the confidence intervals for the coefficient estimates are shown as well at the 95% level.</p>
<pre class="r"><code>lm_coefs &lt;-  full_model %&gt;% 
  pull_workflow_fit() %&gt;% 
  tidy(conf.int=TRUE) 

lm_coefs %&gt;% 
  kableExtra::kable() %&gt;% 
  kableExtra::kable_styling(bootstrap_options = c(&quot;striped&quot;),full_width = F) </code></pre>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
term
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
std.error
</th>
<th style="text-align:right;">
statistic
</th>
<th style="text-align:right;">
p.value
</th>
<th style="text-align:right;">
conf.low
</th>
<th style="text-align:right;">
conf.high
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:right;">
1.6531251
</td>
<td style="text-align:right;">
0.0918856
</td>
<td style="text-align:right;">
17.991124
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
1.4728627
</td>
<td style="text-align:right;">
1.8333875
</td>
</tr>
<tr>
<td style="text-align:left;">
start_cost
</td>
<td style="text-align:right;">
0.5839318
</td>
<td style="text-align:right;">
0.0197358
</td>
<td style="text-align:right;">
29.587376
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.5452138
</td>
<td style="text-align:right;">
0.6226499
</td>
</tr>
<tr>
<td style="text-align:left;">
cost_change_start
</td>
<td style="text-align:right;">
0.1309334
</td>
<td style="text-align:right;">
0.0570783
</td>
<td style="text-align:right;">
2.293924
</td>
<td style="text-align:right;">
0.0219557
</td>
<td style="text-align:right;">
0.0189563
</td>
<td style="text-align:right;">
0.2429104
</td>
</tr>
<tr>
<td style="text-align:left;">
total_points
</td>
<td style="text-align:right;">
0.0120108
</td>
<td style="text-align:right;">
0.0013641
</td>
<td style="text-align:right;">
8.804646
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.0093346
</td>
<td style="text-align:right;">
0.0146870
</td>
</tr>
<tr>
<td style="text-align:left;">
minutes
</td>
<td style="text-align:right;">
-0.0001536
</td>
<td style="text-align:right;">
0.0000292
</td>
<td style="text-align:right;">
-5.259264
</td>
<td style="text-align:right;">
0.0000002
</td>
<td style="text-align:right;">
-0.0002109
</td>
<td style="text-align:right;">
-0.0000963
</td>
</tr>
<tr>
<td style="text-align:left;">
transfers_in
</td>
<td style="text-align:right;">
0.0000004
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
9.448657
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.0000004
</td>
<td style="text-align:right;">
0.0000005
</td>
</tr>
<tr>
<td style="text-align:left;">
transfers_out
</td>
<td style="text-align:right;">
-0.0000003
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
-5.646413
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
-0.0000003
</td>
<td style="text-align:right;">
-0.0000002
</td>
</tr>
<tr>
<td style="text-align:left;">
selected_by_percent
</td>
<td style="text-align:right;">
0.0047812
</td>
<td style="text-align:right;">
0.0034510
</td>
<td style="text-align:right;">
1.385456
</td>
<td style="text-align:right;">
0.1661537
</td>
<td style="text-align:right;">
-0.0019890
</td>
<td style="text-align:right;">
0.0115515
</td>
</tr>
<tr>
<td style="text-align:left;">
points_per_game
</td>
<td style="text-align:right;">
0.0593878
</td>
<td style="text-align:right;">
0.0126955
</td>
<td style="text-align:right;">
4.677881
</td>
<td style="text-align:right;">
0.0000032
</td>
<td style="text-align:right;">
0.0344817
</td>
<td style="text-align:right;">
0.0842939
</td>
</tr>
<tr>
<td style="text-align:left;">
value_season
</td>
<td style="text-align:right;">
-0.0328753
</td>
<td style="text-align:right;">
0.0073572
</td>
<td style="text-align:right;">
-4.468459
</td>
<td style="text-align:right;">
0.0000086
</td>
<td style="text-align:right;">
-0.0473088
</td>
<td style="text-align:right;">
-0.0184419
</td>
</tr>
<tr>
<td style="text-align:left;">
element_type_DEF
</td>
<td style="text-align:right;">
0.0606243
</td>
<td style="text-align:right;">
0.0331248
</td>
<td style="text-align:right;">
1.830178
</td>
<td style="text-align:right;">
0.0674551
</td>
<td style="text-align:right;">
-0.0043604
</td>
<td style="text-align:right;">
0.1256091
</td>
</tr>
<tr>
<td style="text-align:left;">
element_type_MID
</td>
<td style="text-align:right;">
0.3104668
</td>
<td style="text-align:right;">
0.0344373
</td>
<td style="text-align:right;">
9.015410
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.2429072
</td>
<td style="text-align:right;">
0.3780264
</td>
</tr>
<tr>
<td style="text-align:left;">
element_type_FWD
</td>
<td style="text-align:right;">
0.2759441
</td>
<td style="text-align:right;">
0.0425635
</td>
<td style="text-align:right;">
6.483123
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.1924425
</td>
<td style="text-align:right;">
0.3594456
</td>
</tr>
</tbody>
</table>
<ul>
<li>We see that the the higher the initial cost of a player the higher their next season price will be. A positive price change from the start will also increase the player’s price, but a negative one will lead to a decrease.</li>
</ul>
<!-- -->
<ul>
<li><p>The values of points per game and total points also increase the players starting price.</p></li>
<li><p>There is evidence to suggest that the selection by percent variable is not statistical significant in our model.</p></li>
<li><p>Larger number of transfers in increases the next season’s start price, while larger number of transfers out decreases it.</p></li>
<li><p>The more minutes and and the higher the value over season a players contributes to a decrease in starting price.</p></li>
<li><p>For the positions, there is evidence to suggests that a defender is not priced differently than a goalkeeper. While a midfielder is £0.31m more expensive than a goalkeeper, and a forward is £0.28 more expensive than a goalkeeper.</p></li>
</ul>
<p>We can view the results on a plot too</p>
<pre class="r"><code>lm_coefs  %&gt;% 
  filter(term != &quot;(Intercept)&quot;,
         !str_starts(term,&quot;element_type&quot;)  ) %&gt;% 
  mutate( term = fct_reorder(term,estimate) ) %&gt;% 
  mutate(  is_signif =   if_else( p.value &lt; 0.05,TRUE,FALSE)) %&gt;% 
  ggplot()+
  geom_errorbarh(aes(xmin=conf.low,xmax=conf.high,y=term,col=is_signif ))+
  geom_point(aes(x=estimate,y=term))+
  geom_vline(xintercept = 0,lty=2,col=&quot;blue&quot;)+
  labs(title = &quot;Coefficient estimates for linear regression model&quot;,
       x=&quot;Estimated value&quot;,y=&quot;Variable&quot;,
       col=&quot;p value &lt; 0.05?&quot;)+
  scale_color_manual(values=c(&quot;red3&quot;,&quot;forestgreen&quot;))+
  guides(color = guide_legend(reverse = TRUE))+
  theme_light()+
  theme(plot.title.position = &quot;plot&quot;)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<p>Let’s see how the player position changes the next season starting price.</p>
<pre class="r"><code>lm_coefs  %&gt;% 
  filter(str_starts(term,&quot;element_type&quot;)  ) %&gt;% 
  mutate( term = str_remove_all(term,&quot;element_type_&quot;) ) %&gt;% 
  mutate( term =  factor(term,levels=c(&quot;DEF&quot;,&quot;MID&quot;,&quot;FWD&quot;)) ) %&gt;% 
  mutate(  is_signif =   if_else( p.value &lt; 0.05,TRUE,FALSE)) %&gt;% 
  ggplot()+
  geom_errorbarh(aes(xmin=conf.low,xmax=conf.high,y=term,col=is_signif ))+
  geom_point(aes(x=estimate,y=term))+
  geom_vline(xintercept = 0,lty=2)+
  labs( title = &quot;Difference from Goalkeeper price&quot;,
        subtitle = &quot;Coefficient estimates for posistions&quot;,
        x=&quot;Estimated value&quot;,y=&quot;Variable&quot;,
        col=&quot;p value &lt; 0.05?&quot;)+
  scale_color_manual(values=c(&quot;red3&quot;,&quot;forestgreen&quot;))+
  guides(color = guide_legend(reverse = TRUE))+
  theme_light()+
  theme(plot.title.position = &quot;plot&quot;)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<p>From this see that defenders aren’t different from goalkeepers, and midfielders tend to be the most expensive position available.</p>
<div id="extra-look" class="section level2">
<h2>Extra look</h2>
<p>Let’s look at the fit on the full dataset.</p>
<pre class="r"><code>full_pred &lt;-  full_model  %&gt;% 
  predict(new_data=full_clean) %&gt;% 
  bind_cols(full_clean,. ) 

full_pred %&gt;% 
    ggplot(aes(x=.pred,y=next_season_cost,col=element_type)) +
  geom_point(size=2) +
  geom_abline(slope=1,lty=2,col=&quot;blue&quot;)+
  geom_smooth(method=&quot;loess&quot;,col=&quot;darkorange&quot;)+
  labs(title=&quot;Predicted vs actual values of starting price on the full dataset&quot;,
       subtitle=&quot;Dashed line represents line of best fit, orange line represent model&#39;s general fit&quot;,
       x=&quot;Predicted Price&quot;,y=&quot;Actual Price&quot;,col=&quot;Position&quot;) +
  scale_x_continuous(labels = scales::label_dollar(prefix = &quot;£&quot;,suffix = &quot;m&quot;),breaks = seq(4,13,1))+
  scale_y_continuous(labels = scales::label_dollar(prefix = &quot;£&quot;,suffix = &quot;m&quot;),breaks = seq(4,13,1))+
    scale_color_brewer(palette=&quot;Set1&quot;)+
  theme_light()+
  theme(plot.title.position = &quot;plot&quot;)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<p>Overall, it does well but there are a few noticeable points that deviate far from what was actually happened. Let’s break it down by posistion.</p>
<pre class="r"><code>full_pred %&gt;% 
  ggplot(aes(x=.pred,y=next_season_cost,col=element_type)) +
  geom_point(size=2,show.legend = FALSE)+
  facet_wrap(.~element_type,scales = &quot;free&quot;)+
  geom_abline(slope=1,lty=2,col=&quot;black&quot;)+
  geom_smooth(method=&quot;loess&quot;,col=&quot;black&quot;)+
  scale_color_brewer(palette=&quot;Set1&quot;)+
  labs(title=&quot;Predicted vs actual values of starting price on the full dataset by player position&quot;,
       subtitle=&quot;Dashed line represents line of best fit, thick line represent model&#39;s general fit&quot;,
       x=&quot;Predicted Price&quot;,y=&quot;Actual Price&quot;) +
  scale_x_continuous(labels = scales::label_dollar(prefix = &quot;£&quot;,suffix = &quot;m&quot;))+
  scale_y_continuous(labels = scales::label_dollar(prefix = &quot;£&quot;,suffix = &quot;m&quot;))+
  theme_bw()+
  theme(plot.title.position = &quot;plot&quot;)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<p>The model generally does well for MID and FWD, but doesn’t do great with expensive GK and DEF. This was something we noticed earlier.</p>
</div>
</div>
<div id="predicting-fpl-202122-season-prices" class="section level1">
<h1>Predicting FPL 2021/22 season prices</h1>
<p>Now we will use the data from the 2020/21 season and try to predict the prices for the next season of FPL</p>
<pre class="r"><code>clean_2020 &lt;- clean_df(raw_FPL2020)


FPL2021_preds &lt;-  full_model %&gt;% 
    predict(new_data = clean_2020) %&gt;% 
#  predict(new_data = clean_2020,type=&quot;pred_int&quot;) %&gt;% 
  bind_cols(clean_2020,.) %&gt;% 
  bind_cols(full_model %&gt;%  predict(new_data = clean_2020,type=&quot;pred_int&quot;))



FPL2020_teams &lt;- read_csv(file=&quot;https://raw.githubusercontent.com/vaastav/Fantasy-Premier-League/master/data/2020-21/teams.csv&quot;)
FPL2020_teams &lt;- FPL2020_teams %&gt;% 
  select(id,name)

FPL2021_prices &lt;-  FPL2021_preds %&gt;% 
  left_join(FPL2020_teams,by =  c(&quot;team&quot;=&quot;id&quot;)       ) %&gt;% 
  left_join(raw_FPL2020 %&gt;% select(id,web_name) , by = &quot;id&quot; ) %&gt;% 
  mutate( price_diff = .pred - final_cost)  %&gt;% 
  select(id,full_name,web_name,element_type,team=name,minutes,total_points,start_cost,final_cost,.pred,price_diff,.pred_lower,.pred_upper) %&gt;% 
  mutate( full_name = str_to_title(full_name),
          team = as.factor(team)) %&gt;% 
  arrange(team,element_type)
  


FPL2021_prices %&gt;% 
  mutate(  across(.pred:.pred_upper, ~ round(.x,1) ) ) %&gt;% 
  select(-id,-full_name) %&gt;% 
  select(&quot;Name&quot;=1,&quot;Position&quot;=2,&quot;Team&quot;=3,&quot;Minutes Played&quot;=4,&quot;Total Points&quot;=5,&quot;Start Cost (2020/21)&quot;=6,&quot;Final Cost (2020/21)&quot;=7,
         &quot;Predicted Start Cost (2021/22)&quot;=8,&quot;Price Change&quot;=9,&quot;Predicted Lower Bound&quot;=10,&quot;Predicted Higher Bound&quot;=11) %&gt;% 
DT::datatable(filter = &quot;top&quot;)</code></pre>
<div id="htmlwidget-1" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-1">{"x":{"filter":"top","filterHTML":"<tr>\n  <td><\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;GK&quot;,&quot;DEF&quot;,&quot;MID&quot;,&quot;FWD&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;Arsenal&quot;,&quot;Aston Villa&quot;,&quot;Brighton&quot;,&quot;Burnley&quot;,&quot;Chelsea&quot;,&quot;Crystal Palace&quot;,&quot;Everton&quot;,&quot;Fulham&quot;,&quot;Leeds&quot;,&quot;Leicester&quot;,&quot;Liverpool&quot;,&quot;Man City&quot;,&quot;Man Utd&quot;,&quot;Newcastle&quot;,&quot;Sheffield Utd&quot;,&quot;Southampton&quot;,&quot;Spurs&quot;,&quot;West Brom&quot;,&quot;West Ham&quot;,&quot;Wolves&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"0\" data-max=\"3420\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"-3\" data-max=\"244\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"4\" data-max=\"12\" data-scale=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"3.8\" data-max=\"12.9\" data-scale=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"3.8\" data-max=\"12.9\" data-scale=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"-1.8\" data-max=\"2.4\" data-scale=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"3.2\" data-max=\"12.2\" data-scale=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"4.5\" data-max=\"13.5\" data-scale=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249","250","251","252","253","254","255","256","257","258","259","260","261","262","263","264","265","266","267","268","269","270","271","272","273","274","275","276","277","278","279","280","281","282","283","284","285","286","287","288","289","290","291","292","293","294","295","296","297","298","299","300","301","302","303","304","305","306","307","308","309","310","311","312","313","314","315","316","317","318","319","320","321","322","323","324","325","326","327","328","329","330","331","332","333","334","335","336","337","338","339","340","341","342","343","344","345","346","347","348","349","350","351","352","353","354","355","356","357","358","359","360","361","362","363","364","365","366","367","368","369","370","371","372","373","374","375","376","377","378","379","380","381","382","383","384","385","386","387","388","389","390","391","392","393","394","395","396","397","398","399","400","401","402","403","404","405","406","407","408","409","410","411","412","413","414","415","416","417","418","419","420","421","422","423","424","425","426","427","428","429","430","431","432","433","434","435","436","437","438","439","440","441","442","443","444","445","446","447","448","449","450","451","452","453","454","455","456","457","458","459","460","461","462","463","464","465","466","467","468","469","470","471","472","473","474","475","476","477","478","479","480","481","482","483","484","485","486","487","488","489","490","491","492","493","494","495","496","497","498","499","500","501","502","503","504","505","506","507","508","509","510","511","512","513","514","515","516","517","518","519","520","521","522","523","524","525","526","527","528","529","530","531","532","533","534","535","536","537","538","539","540","541","542","543","544","545","546","547","548","549","550","551","552","553","554","555","556","557","558","559","560","561","562","563","564","565","566","567","568","569","570","571","572","573","574","575","576","577","578","579","580","581","582","583","584","585","586","587","588","589","590","591","592","593","594","595","596","597","598","599","600","601","602","603","604","605","606","607","608","609","610","611","612","613","614","615","616","617","618","619","620","621","622","623","624","625","626","627","628","629","630","631","632","633","634","635","636","637","638","639","640","641","642","643","644","645","646","647","648","649","650","651","652","653","654","655","656","657","658","659","660","661","662","663","664","665","666","667","668","669","670","671","672","673","674","675","676","677","678","679","680","681","682","683","684","685","686","687","688","689","690","691","692","693","694","695","696","697","698","699","700","701","702","703","704","705","706","707","708","709","710","711","712"],["Leno","Ryan","Macey","Rúnarsson","Sokratis","David Luiz","Cédric","Mustafi","Marí","Bellerín","Chambers","Kolasinac","Holding","Tierney","Saliba","Gabriel","Özil","Aubameyang","Xhaka","Pépé","Torreira","Nelson","Smith Rowe","Saka","Guendouzi","Martinelli","Willian","Ceballos","Elneny","Partey","Ødegaard","Azeez","Lacazette","Nketiah","Martínez","Heaton","Steer","Nyland","El Mohamady","Taylor","Engels","Hause","Mings","Targett","Bree","Konsa","Guilbert","Cash","Lansbury","Hourihane","Jota","Grealish","McGinn","Trézéguet","Nakamba","El Ghazi","Douglas Luiz","Barkley","Traoré","Ramsey","Sanson","Hayden","Chukwuemeka","Philogene-Bidace","Wesley","Samatta","Davis","Vassilev","Watkins","Walton","Steele","Sánchez","McGill","Duffy","Burn","Dunk","Montoya","Webster","Veltman","Clarke","White","Bernardo","Lamptey","Karbownik","Lallana","Groß","Pröpper","Mooy","March","Trossard","Jahanbakhsh","Izquierdo","Bissouma","Alzate","Mac Allister","Molumby","Tau","Moder","Khadra","Jenks","Sanders","Weir","Caicedo","Murray","Andone","Maupay","Connolly","Zeqiri","Welbeck","Pope","Peacock-Farrell","Norris","Tarkowski","Bardsley","Pieters","Long","Mee","Lowton","Gibson","Taylor","Dunne","Thomas","Driscoll-Glennon","Nartey","Stephens","Cork","Westwood","Gudmundsson","Brady","Brownhill","McNeil","Benson","Goodridge","Mancini","Rodriguez","Barnes","Wood","Vydra","Thompson","Richardson","Mumbongo","Caballero","Arrizabalaga","Mendy","Ziger","Azpilicueta","Alonso","Rüdiger","Zouma","Emerson","Christensen","Tomori","James","Chilwell","Thiago Silva","Livramento","Jorginho","Kovacic","Kanté","Ziyech","Pulisic","Mount","Hudson-Odoi","Gilmour","Havertz","Anjorin","Giroud","Werner","Abraham","Hennessey","Guaita","Henderson","Butland","Cahill","Sakho","Tomkins","Ward","Kelly","van Aanholt","Ferguson","Mitchell","Dann","Woods","Inniss","Clyne","Hannam","McArthur","McCarthy","Kouyaté","Townsend","Milivojevic","Zaha","Schlupp","Meyer","Riedewald","Pierrick","Eze","Rak-Sakyi","Batshuayi","Benteke","Wickham","Ayew","Mateta","Lössl","Pickford","Virgínia","Olsen","Tyrer","Coleman","Digne","Keane","Kenny","Mina","Holgate","Branthwaite","Nkounkou","Godfrey","John","Astley","Welch","Delph","Sigurdsson","Bernard","André Gomes","Iwobi","Gbamin","Davies","Gordon","Allan","Rodríguez","Doucouré","Onyango","Broadhead","Price","Tosun","Calvert-Lewin","Richarlison","Kean","Simms","King","Fabri","Bettinelli","Rodák","Areola","Le Marchand","Ream","Hector","Christie","Bryan","Mawson","Sessegnon","Robinson","Tete","Odoi","Aina","Andersen","Adarabioyo","Kongolo","Loftus-Cheek","McDonald","Johansen","Cairney","Knockaert","Kebano","Cavaleiro","Onomah","Seri","Kamara","Anguissa","Reed","Lemina","Lookman","Carvalho","Jasper","Francois","Decordova-Reid","Mitrović","Maja","Casilla","Miazek","Meslier","Caprile","Cooper","Douglas","Ayling","Dallas","Alioski","Struijk","Davis","Casey","Koch","Llorente","Cresswell","Berardi","Drameh","Hernández","Klich","Forshaw","Harrison","Phillips","Costa","Roberts","Grot","Poveda-Ocampo","Shackleton","Stevens","Bogusz","Raphinha","Jenkins","Summerville","Bamford","Rodrigo","Huggins","Gelhardt","Greenwood","Schmeichel","Ward","Morgan","Fuchs","Evans","Pereira","Amartey","Benkovic","Söyüncü","Justin","Thomas","Castagne","Fofana","Daley-Campbell","Silva","Albrighton","James","Praet","Tielemans","Pérez","Gray","Maddison","Choudhury","Barnes","Ndidi","Mendy","Ünder","Leshabela","Tavares","Flynn","Suengchitthawon","Maswanhise","Vardy","Iheanacho","Slimani","Adrián","Alisson","Kelleher","Hughes","Ojrzynski","Tsimikas","Matip","van Dijk","Robertson","Alexander-Arnold","Gomez","Neco Williams","Phillips","Rhys Williams","Kabak","Koumetio","Milner","Wijnaldum","Henderson","Shaqiri","Chamberlain","Mané","Fabinho","Salah","Harry Wilson","Keita","Jones","Elliott","Jota","Thiago","Clarkson","Cain","Woodburn","Firmino","Origi","Bravo","Ederson","Steffen","Trafford","Carson","Fernandinho","Otamendi","Walker","Stones","Mendy","Cancelo","Aké","Laporte","Zinchenko","Garcia","Dias","Mbete","Harwood-Bellis","Gündogan","De Bruyne","Mahrez","Sterling","Bernardo Silva","Foden","Doyle","Rodrigo","Torres","Bernabé","Palmer","Nmecha","Gomes","Agüero","Jesus","Delap","Romero","de Gea","Henderson","Grant","Bishop","Smalling","Rojo","Jones","Maguire","Shaw","Tuanzebe","Lindelöf","Bailly","Fosu-Mensah","Wan-Bissaka","Dalot","Williams","Mengi","Telles","Fish","Mata","Matic","Pogba","Fred","Fernandes","Pereira","Rashford","McTominay","James","Greenwood","Chong","Garner","van de Beek","Pellistri","Diallo","Shoretire","Elanga","Mejbri","Ighalo","Martial","Cavani","Darlow","Dubravka","Gillespie","Langley","Fernández","Clark","Lejeune","Lascelles","Dummett","Manquillo","Krafth","Schär","Yedlin","Watts","Lewis","Willock","Shelvey","Ritchie","Atsu","Hayden","Aarons","Saint-Maximin","Almirón","Sean Longstaff","Hendrick","Matty Longstaff","Murphy","Fraser","Anderson","Carroll","Gayle","Joelinton","Muto","Wilson","Moore","Foderingham","Ramsdale","Verrips","Basham","Stevens","Baldock","Jack Robinson","Egan","O'Connell","Ampadu","Bogle","Lowe","Jagielka","Bryan","Gordon","Boyes","Fleck","Norwood","Lundstram","Osborn","Berge","Burke","Freeman","Ndiaye","Brunt","Maguire","Seriki","Brewster","Sharp","McGoldrick","McBurnie","Mousset","Hackford","Jebbison","Osula","McCarthy","Gunn","Forster","Lewis","Bertrand","Stephens","Vestergaard","Walker-Peters","Bednarek","Valery","Vokins","Salisu","Ramsay","Tchaptchet","Walcott","Minamino","Oriol Romeu","Redmond","Armstrong","Ward-Prowse","Boufal","Sims","Smallbone","Djenepo","Tella","Diallo","Chauke","Ferry","Watts","Jankewitz","Finnigan","Long","Ings","Adams","Obafemi","N'Lundulu","Lloris","Gazzaniga","Hart","Rose","Alderweireld","Aurier","Dier","Davies","Sánchez","Sessegnon","Tanganga","Foyth","Doherty","Carter-Vickers","Reguilón","Rodon","Sissoko","Lamela","Son","Lucas Moura","Alli","Højbjerg","Winks","Bergwijn","Fernandes","Lo Celso","Skipp","Ndombele","Bale","Devine","John","Kane","Carlos Vinicius","Scarlett","Button","Johnstone","Lonergan","Maitland-Niles","Gibbs","Bartley","Hegazi","Townsend","Ajayi","Furlong","O'Shea","Kipre","Ivanovic","Peltier","Taylor","Livermore","Grosicki","Phillips","Sawyers","Leko","Edwards","Field","Harper","Snodgrass","Diangana","Pereira","Gallagher","Krovinovic","Yokuslu","Gardner-Hickman","King","Iroegbunam","Callum Robinson","Robson-Kanu","Austin","Zohore","Grant","Diaby","Diagne","Martin","Randolph","Fabianski","Roberto","Trott","Ogbonna","Cresswell","Fredericks","Masuaku","Balbuena","Diop","Johnson","Coufal","Dawson","Alves","Baptiste","Lingard","Noble","Wilshere","Yarmolenko","Lanzini","Felipe Anderson","Bowen","Rice","Soucek","Fornals","Benrahma","Coventry","Antonio","Haller","Hugill","Ajeti","Odubeko","Ruddy","Patrício","Sarkic","Söndergaard","Bennett","Boly","Coady","Saïss","Jonny","Buur","Kilman","Vinagre","Marçal","Hoever","Semedo","Ait Nouri","Richards","Marques","Lonwijk","Bueno","Moutinho","Dendoncker","Traoré","Neves","Podence","Gibbs-White","Neto","Jordao","Vitinha","Shabani","Otasowie","Corbeanu","Perry","Cundle","Jiménez","Bonatini","Campana","Fabio Silva","Cutrone","Willian José"],["GK","GK","GK","GK","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","FWD","FWD","GK","GK","GK","GK","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","FWD","FWD","FWD","FWD","FWD","GK","GK","GK","GK","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","FWD","FWD","FWD","FWD","FWD","FWD","GK","GK","GK","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","FWD","FWD","FWD","FWD","FWD","FWD","FWD","GK","GK","GK","GK","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","FWD","FWD","FWD","GK","GK","GK","GK","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","FWD","FWD","FWD","FWD","FWD","GK","GK","GK","GK","GK","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","FWD","FWD","FWD","FWD","FWD","FWD","GK","GK","GK","GK","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","FWD","FWD","FWD","GK","GK","GK","GK","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","FWD","FWD","FWD","FWD","FWD","GK","GK","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","FWD","FWD","FWD","GK","GK","GK","GK","GK","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","FWD","FWD","GK","GK","GK","GK","GK","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","FWD","FWD","FWD","GK","GK","GK","GK","GK","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","FWD","FWD","FWD","GK","GK","GK","GK","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","FWD","FWD","FWD","FWD","FWD","GK","GK","GK","GK","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","FWD","FWD","FWD","FWD","FWD","FWD","FWD","FWD","GK","GK","GK","GK","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","FWD","FWD","FWD","FWD","FWD","GK","GK","GK","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","FWD","FWD","FWD","GK","GK","GK","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","FWD","FWD","FWD","FWD","FWD","FWD","FWD","GK","GK","GK","GK","GK","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","FWD","FWD","FWD","FWD","FWD","GK","GK","GK","GK","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","DEF","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","MID","FWD","FWD","FWD","FWD","FWD","FWD"],["Arsenal","Arsenal","Arsenal","Arsenal","Arsenal","Arsenal","Arsenal","Arsenal","Arsenal","Arsenal","Arsenal","Arsenal","Arsenal","Arsenal","Arsenal","Arsenal","Arsenal","Arsenal","Arsenal","Arsenal","Arsenal","Arsenal","Arsenal","Arsenal","Arsenal","Arsenal","Arsenal","Arsenal","Arsenal","Arsenal","Arsenal","Arsenal","Arsenal","Arsenal","Aston Villa","Aston Villa","Aston Villa","Aston Villa","Aston Villa","Aston Villa","Aston Villa","Aston Villa","Aston Villa","Aston Villa","Aston Villa","Aston Villa","Aston Villa","Aston Villa","Aston Villa","Aston Villa","Aston Villa","Aston Villa","Aston Villa","Aston Villa","Aston Villa","Aston Villa","Aston Villa","Aston Villa","Aston Villa","Aston Villa","Aston Villa","Aston Villa","Aston Villa","Aston Villa","Aston Villa","Aston Villa","Aston Villa","Aston Villa","Aston Villa","Brighton","Brighton","Brighton","Brighton","Brighton","Brighton","Brighton","Brighton","Brighton","Brighton","Brighton","Brighton","Brighton","Brighton","Brighton","Brighton","Brighton","Brighton","Brighton","Brighton","Brighton","Brighton","Brighton","Brighton","Brighton","Brighton","Brighton","Brighton","Brighton","Brighton","Brighton","Brighton","Brighton","Brighton","Brighton","Brighton","Brighton","Brighton","Brighton","Brighton","Burnley","Burnley","Burnley","Burnley","Burnley","Burnley","Burnley","Burnley","Burnley","Burnley","Burnley","Burnley","Burnley","Burnley","Burnley","Burnley","Burnley","Burnley","Burnley","Burnley","Burnley","Burnley","Burnley","Burnley","Burnley","Burnley","Burnley","Burnley","Burnley","Burnley","Burnley","Burnley","Chelsea","Chelsea","Chelsea","Chelsea","Chelsea","Chelsea","Chelsea","Chelsea","Chelsea","Chelsea","Chelsea","Chelsea","Chelsea","Chelsea","Chelsea","Chelsea","Chelsea","Chelsea","Chelsea","Chelsea","Chelsea","Chelsea","Chelsea","Chelsea","Chelsea","Chelsea","Chelsea","Chelsea","Crystal Palace","Crystal Palace","Crystal Palace","Crystal Palace","Crystal Palace","Crystal Palace","Crystal Palace","Crystal Palace","Crystal Palace","Crystal Palace","Crystal Palace","Crystal Palace","Crystal Palace","Crystal Palace","Crystal Palace","Crystal Palace","Crystal Palace","Crystal Palace","Crystal Palace","Crystal Palace","Crystal Palace","Crystal Palace","Crystal Palace","Crystal Palace","Crystal Palace","Crystal Palace","Crystal Palace","Crystal Palace","Crystal Palace","Crystal Palace","Crystal Palace","Crystal Palace","Crystal Palace","Crystal Palace","Everton","Everton","Everton","Everton","Everton","Everton","Everton","Everton","Everton","Everton","Everton","Everton","Everton","Everton","Everton","Everton","Everton","Everton","Everton","Everton","Everton","Everton","Everton","Everton","Everton","Everton","Everton","Everton","Everton","Everton","Everton","Everton","Everton","Everton","Everton","Everton","Everton","Fulham","Fulham","Fulham","Fulham","Fulham","Fulham","Fulham","Fulham","Fulham","Fulham","Fulham","Fulham","Fulham","Fulham","Fulham","Fulham","Fulham","Fulham","Fulham","Fulham","Fulham","Fulham","Fulham","Fulham","Fulham","Fulham","Fulham","Fulham","Fulham","Fulham","Fulham","Fulham","Fulham","Fulham","Fulham","Fulham","Fulham","Fulham","Leeds","Leeds","Leeds","Leeds","Leeds","Leeds","Leeds","Leeds","Leeds","Leeds","Leeds","Leeds","Leeds","Leeds","Leeds","Leeds","Leeds","Leeds","Leeds","Leeds","Leeds","Leeds","Leeds","Leeds","Leeds","Leeds","Leeds","Leeds","Leeds","Leeds","Leeds","Leeds","Leeds","Leeds","Leeds","Leeds","Leeds","Leicester","Leicester","Leicester","Leicester","Leicester","Leicester","Leicester","Leicester","Leicester","Leicester","Leicester","Leicester","Leicester","Leicester","Leicester","Leicester","Leicester","Leicester","Leicester","Leicester","Leicester","Leicester","Leicester","Leicester","Leicester","Leicester","Leicester","Leicester","Leicester","Leicester","Leicester","Leicester","Leicester","Leicester","Leicester","Liverpool","Liverpool","Liverpool","Liverpool","Liverpool","Liverpool","Liverpool","Liverpool","Liverpool","Liverpool","Liverpool","Liverpool","Liverpool","Liverpool","Liverpool","Liverpool","Liverpool","Liverpool","Liverpool","Liverpool","Liverpool","Liverpool","Liverpool","Liverpool","Liverpool","Liverpool","Liverpool","Liverpool","Liverpool","Liverpool","Liverpool","Liverpool","Liverpool","Liverpool","Liverpool","Man City","Man City","Man City","Man City","Man City","Man City","Man City","Man City","Man City","Man City","Man City","Man City","Man City","Man City","Man City","Man City","Man City","Man City","Man City","Man City","Man City","Man City","Man City","Man City","Man City","Man City","Man City","Man City","Man City","Man City","Man City","Man City","Man City","Man City","Man Utd","Man Utd","Man Utd","Man Utd","Man Utd","Man Utd","Man Utd","Man Utd","Man Utd","Man Utd","Man Utd","Man Utd","Man Utd","Man Utd","Man Utd","Man Utd","Man Utd","Man Utd","Man Utd","Man Utd","Man Utd","Man Utd","Man Utd","Man Utd","Man Utd","Man Utd","Man Utd","Man Utd","Man Utd","Man Utd","Man Utd","Man Utd","Man Utd","Man Utd","Man Utd","Man Utd","Man Utd","Man Utd","Man Utd","Man Utd","Man Utd","Newcastle","Newcastle","Newcastle","Newcastle","Newcastle","Newcastle","Newcastle","Newcastle","Newcastle","Newcastle","Newcastle","Newcastle","Newcastle","Newcastle","Newcastle","Newcastle","Newcastle","Newcastle","Newcastle","Newcastle","Newcastle","Newcastle","Newcastle","Newcastle","Newcastle","Newcastle","Newcastle","Newcastle","Newcastle","Newcastle","Newcastle","Newcastle","Newcastle","Newcastle","Sheffield Utd","Sheffield Utd","Sheffield Utd","Sheffield Utd","Sheffield Utd","Sheffield Utd","Sheffield Utd","Sheffield Utd","Sheffield Utd","Sheffield Utd","Sheffield Utd","Sheffield Utd","Sheffield Utd","Sheffield Utd","Sheffield Utd","Sheffield Utd","Sheffield Utd","Sheffield Utd","Sheffield Utd","Sheffield Utd","Sheffield Utd","Sheffield Utd","Sheffield Utd","Sheffield Utd","Sheffield Utd","Sheffield Utd","Sheffield Utd","Sheffield Utd","Sheffield Utd","Sheffield Utd","Sheffield Utd","Sheffield Utd","Sheffield Utd","Sheffield Utd","Sheffield Utd","Sheffield Utd","Southampton","Southampton","Southampton","Southampton","Southampton","Southampton","Southampton","Southampton","Southampton","Southampton","Southampton","Southampton","Southampton","Southampton","Southampton","Southampton","Southampton","Southampton","Southampton","Southampton","Southampton","Southampton","Southampton","Southampton","Southampton","Southampton","Southampton","Southampton","Southampton","Southampton","Southampton","Southampton","Southampton","Southampton","Southampton","Southampton","Spurs","Spurs","Spurs","Spurs","Spurs","Spurs","Spurs","Spurs","Spurs","Spurs","Spurs","Spurs","Spurs","Spurs","Spurs","Spurs","Spurs","Spurs","Spurs","Spurs","Spurs","Spurs","Spurs","Spurs","Spurs","Spurs","Spurs","Spurs","Spurs","Spurs","Spurs","Spurs","Spurs","Spurs","West Brom","West Brom","West Brom","West Brom","West Brom","West Brom","West Brom","West Brom","West Brom","West Brom","West Brom","West Brom","West Brom","West Brom","West Brom","West Brom","West Brom","West Brom","West Brom","West Brom","West Brom","West Brom","West Brom","West Brom","West Brom","West Brom","West Brom","West Brom","West Brom","West Brom","West Brom","West Brom","West Brom","West Brom","West Brom","West Brom","West Brom","West Brom","West Brom","West Ham","West Ham","West Ham","West Ham","West Ham","West Ham","West Ham","West Ham","West Ham","West Ham","West Ham","West Ham","West Ham","West Ham","West Ham","West Ham","West Ham","West Ham","West Ham","West Ham","West Ham","West Ham","West Ham","West Ham","West Ham","West Ham","West Ham","West Ham","West Ham","West Ham","West Ham","West Ham","West Ham","Wolves","Wolves","Wolves","Wolves","Wolves","Wolves","Wolves","Wolves","Wolves","Wolves","Wolves","Wolves","Wolves","Wolves","Wolves","Wolves","Wolves","Wolves","Wolves","Wolves","Wolves","Wolves","Wolves","Wolves","Wolves","Wolves","Wolves","Wolves","Wolves","Wolves","Wolves","Wolves","Wolves","Wolves","Wolves","Wolves","Wolves","Wolves","Wolves","Wolves"],[3131,1260,0,15,0,1396,744,45,900,2089,751,90,2557,2299,0,1996,0,2330,2519,1606,0,70,1438,2554,0,582,1398,1609,1538,1529,861,0,1916,411,3420,0,0,0,833,15,0,630,3194,3404,0,3195,0,2373,0,225,0,2183,3330,1157,747,1604,2781,1566,2315,611,288,0,18,1,15,0,265,0,3328,0,0,2430,0,0,2057,2932,0,2594,2280,0,3192,205,887,0,1584,2479,209,0,1670,2602,520,8,3112,892,1108,1,101,643,4,0,0,0,0,0,0,2508,783,164,1541,2880,360,180,3240,273,1260,636,2693,3060,0,2425,270,0,0,0,257,1350,3410,1358,1047,2812,3068,260,0,0,1248,1324,2741,1359,0,3,37,90,585,2745,0,2187,958,1710,2027,88,1371,45,2367,2286,1935,0,2006,1809,2140,1164,1731,2887,1050,259,1512,0,740,2598,1031,0,3330,0,90,1800,275,551,2255,1,1775,0,1710,1350,0,0,1145,0,1465,816,3121,2250,2357,2612,1415,0,1810,0,2555,0,717,1808,0,2086,215,0,2742,47,630,0,1607,2681,2989,78,1936,2286,0,80,2683,0,0,0,260,2244,447,1559,1530,11,1417,87,2050,1763,2443,0,2,0,44,2871,2862,13,0,138,0,0,180,3240,122,630,262,0,663,0,0,2159,1477,270,2664,2729,2953,90,1962,0,0,758,0,116,2465,369,0,307,2581,2243,1696,2746,254,0,14,2367,1389,804,270,0,3150,0,2186,0,3399,3410,2456,2072,31,0,1130,1203,0,113,0,414,2386,0,2846,2428,1150,1330,0,344,454,0,0,2358,0,0,3052,1279,37,0,0,3420,0,16,701,2473,954,718,0,1816,2070,968,2345,2260,0,0,1735,0,714,3356,1322,18,2093,311,1944,2175,1452,275,9,84,0,0,0,2838,1452,19,270,2970,180,0,0,6,690,370,3384,3029,589,247,1455,659,801,0,1056,2938,1704,548,243,2808,2566,3077,0,517,1169,0,1106,1851,0,0,0,2837,180,0,3240,90,0,90,1182,0,1944,1933,951,2298,797,1343,1473,380,2843,0,0,2025,1995,1945,2534,2063,1607,0,2747,1297,0,0,0,0,554,2056,39,0,2295,1125,0,0,0,0,0,3047,2653,402,2585,915,80,3060,0,187,0,689,1,507,1101,1892,2389,3101,0,2917,2124,907,1813,0,0,511,0,165,9,155,8,9,1477,1364,2250,1170,0,0,2080,1890,0,1625,1254,822,1286,1255,435,0,1833,1210,2616,1347,0,1942,0,1554,2426,1405,1418,376,1617,922,3,380,501,1979,0,2081,0,0,3420,0,2576,2700,2787,875,2628,180,2087,1107,549,524,1003,0,0,2573,2214,2027,1599,1119,1260,0,11,0,0,1,1113,725,2391,1316,287,10,283,0,2700,0,720,0,2598,1537,2574,2646,3100,101,66,841,90,12,1629,999,1762,1727,2764,3420,0,0,171,1229,735,1010,0,0,36,2,0,201,2172,2662,57,102,3420,0,0,0,2240,1605,2520,1340,1486,0,487,0,1238,0,2244,732,1576,700,3119,1397,613,3420,856,1202,0,939,0,2086,912,0,0,3083,305,1,90,3330,0,1714,810,2583,90,2234,2779,2931,2099,0,764,228,0,1241,147,1815,1486,0,114,61,30,528,1230,2574,2530,541,1316,0,0,0,1552,544,135,0,1120,0,1188,0,270,3150,0,0,2492,3170,564,1006,1197,1379,516,3054,1925,0,0,1423,701,0,362,556,2,2556,2880,3420,2571,1376,0,1972,932,0,0,0,91,3330,0,0,0,1879,3303,2407,496,22,1307,172,618,573,2983,1400,0,0,0,0,2526,2498,2640,2670,1661,407,2549,0,509,0,185,8,0,0,824,0,0,1352,23,1106],[131,37,0,1,0,41,28,3,34,94,36,2,105,96,0,78,0,131,70,114,0,2,74,114,0,36,78,62,50,47,40,0,129,36,186,0,0,0,33,-1,0,32,128,138,0,119,0,89,0,20,0,135,114,56,27,111,72,76,135,28,10,0,2,1,3,0,23,0,168,0,0,101,0,0,64,130,0,85,96,0,104,5,35,0,58,116,9,0,69,132,24,1,77,35,48,1,7,21,1,0,0,0,0,0,0,105,38,9,89,144,3,3,109,2,50,14,102,103,0,83,9,0,0,0,8,33,112,50,44,74,113,10,0,0,54,52,138,62,0,2,3,1,26,140,0,113,57,93,108,7,61,0,112,139,92,0,114,54,62,70,82,147,59,8,91,0,47,128,69,0,124,0,2,53,4,18,66,1,54,0,58,39,0,0,28,0,45,26,82,94,63,136,65,0,64,0,125,0,41,106,0,70,15,0,114,2,25,0,81,120,127,5,79,80,0,2,100,0,0,0,8,122,21,48,65,1,47,3,47,101,80,0,1,0,4,165,123,2,0,11,0,0,2,124,1,10,0,0,27,0,0,57,50,1,102,93,100,2,66,0,0,27,0,6,85,13,0,8,76,69,55,107,12,0,1,88,63,40,14,0,154,0,59,0,100,171,110,71,2,0,38,50,0,8,0,28,99,0,160,67,63,49,0,14,17,0,0,133,0,0,194,89,1,0,0,128,0,3,24,109,27,19,0,59,101,26,94,71,0,0,78,0,37,133,58,1,133,14,126,79,41,16,1,3,0,0,0,187,110,1,11,140,10,0,0,2,42,15,161,160,10,11,68,28,26,0,44,97,56,26,21,176,71,231,0,15,50,0,86,55,0,0,0,141,10,0,160,2,0,7,65,0,91,128,63,138,29,58,69,6,142,0,0,157,141,145,154,94,135,0,91,95,0,0,0,0,38,115,1,0,91,44,0,0,0,0,0,124,124,7,102,31,0,144,0,5,0,25,1,32,36,92,69,244,0,174,91,43,106,0,0,32,0,8,2,11,1,1,75,99,80,48,0,0,53,46,0,44,40,28,45,30,13,0,44,79,74,52,0,40,0,85,97,41,52,10,69,39,1,30,31,74,0,134,0,0,123,0,51,56,63,32,57,3,44,39,9,5,29,0,0,70,54,48,51,31,46,0,1,0,0,1,34,39,100,44,13,1,12,0,94,0,30,0,78,41,86,93,94,3,1,14,-3,0,76,48,52,67,115,156,0,0,5,46,36,31,0,0,2,-1,0,12,131,137,4,13,149,0,0,0,88,80,77,52,43,0,14,0,47,0,89,27,44,28,228,80,30,107,19,55,0,35,0,99,113,0,0,242,13,1,2,140,0,68,5,79,6,76,51,79,41,0,20,2,0,25,8,69,33,0,5,3,2,14,39,153,71,17,34,0,0,0,79,30,5,0,41,0,57,0,10,133,0,0,100,153,28,42,39,42,25,128,75,0,0,106,27,0,17,28,2,141,86,147,125,73,0,118,41,0,0,0,4,132,0,0,0,68,106,99,16,1,58,1,19,13,109,54,0,0,0,0,73,77,94,104,75,22,124,0,26,0,9,1,0,0,43,0,0,72,2,40],[5,4.5,4,4.5,5,5.5,5,5,4.5,5,4.5,5,4.5,5.5,4.5,5,7,12,5.5,8,5,5.5,4.5,5.5,5,5,8,5,4.5,5,6,4.5,8.5,6,4.5,4.5,4,4,4.5,4.5,4.5,4.5,5,4.5,4.5,4.5,4.5,5,4.5,6,6,7,5.5,5.5,4.5,6,5,6,6,4.5,5.5,4.5,4.5,4.5,6,6,4.5,4.5,6,4,4,4.5,4,4.5,4.5,5,4.5,4.5,4.5,4.5,4.5,4,4.5,4.5,6.5,6,5,5,5,6,5.5,5.5,4.5,4.5,5.5,4.5,5.5,5,4.5,4.5,4.5,4.5,5,5,5,6.5,5.5,5,5.5,5.5,4,4,5.5,4.5,4.5,4.5,5,4.5,4,4.5,4,4,4,4,4.5,5,5.5,5.5,5,5,6,4.5,4.5,4.5,6,6,6.5,5,4.5,4.5,4.5,5,5,5,4,6,6,5,5,5,5,5,5,5.5,5.5,4,5,5.5,5,8,8.5,7,6,4.5,8.5,4.5,7,9.5,7.5,4.5,5,4,4.5,4.5,4.5,4.5,4.5,4.5,5.5,4,4,4.5,4,4,4.5,4,5.5,4.5,5,6,6,7,5.5,5,4.5,4.5,6,4.5,6,5.5,4.5,6,6,4.5,5,4.5,4.5,4,5,6,5,4.5,5.5,5,4,4,5,4,4,4,5,7,6,5.5,6,5,5.5,4.5,5.5,7.5,5.5,4.5,4.5,4.5,6,7,8,6,4.5,5.5,4,4.5,4.5,4.5,4.5,4.5,4.5,4.5,5,4.5,4.5,4.5,4.5,4.5,4.5,4.5,4.5,4.5,6,5,5,5.5,5.5,5,5.5,5,5,5,4.5,4.5,4.5,5,4.5,4.5,4.5,5.5,6,5.5,4.5,4,4.5,4,4.5,4,4.5,4.5,4.5,4,4,4,4.5,4.5,4,4,4,6,5.5,5,5.5,5,5.5,5,5,4.5,5,4.5,4.5,5.5,4.5,4.5,5.5,6,4.5,4.5,4.5,5.5,4.5,4.5,4.5,5.5,6,4,4.5,5.5,4.5,4.5,5.5,5,4,4.5,5.5,4.5,5.5,6.5,6.5,5.5,7,5,7,5,4.5,6,4.5,4.5,4.5,4.5,4.5,10,6,5,4.5,6,4.5,4,4,5,5.5,6.5,7,7.5,5.5,4,4,4,5,4,5.5,5.5,5.5,6.5,6.5,12,5.5,12,5.5,5.5,4.5,4.5,6.5,6,4.5,4.5,4.5,9.5,5.5,4.5,6,4.5,4,4,5.5,5,6,5,6,5.5,5.5,6,5.5,5,5.5,4,4,5.5,11.5,8.5,11.5,7.5,6.5,4.5,5.5,7,4.5,4.5,4.5,4.5,10.5,9.5,4.5,5,5.5,5.5,4,4,5,5,5,5.5,5,4.5,5,5,4.5,5.5,5,4.5,4,5.5,4,6,5,8,5.5,10.5,5,9.5,5,6.5,7.5,4.5,4.5,7,5.5,5.5,4.5,4.5,4.5,6.5,9,8,5,5,4.5,4,5,4.5,4.5,4.5,4.5,4.5,4.5,5,4.5,4,4.5,5,5.5,5,5.5,5,5,5.5,6,5,5,5,5,6,4.5,5.5,6,6,5,6.5,4.5,4.5,5,4,5,5.5,5.5,4.5,5,5,4.5,4.5,4.5,4,4,4,4,6,5,5.5,5,5,4.5,5,4.5,4.5,4.5,4.5,4.5,6,5.5,6,6,4.5,4.5,4.5,4.5,4.5,4,4,5,5,4.5,4.5,4.5,5,4,4.5,4,4,6,6.5,4.5,6.5,5.5,6,5.5,4.5,4.5,5.5,4.5,4.5,4.5,4.5,4.5,4.5,4.5,5.5,8.5,6,5,4.5,5.5,4.5,4.5,5,5.5,5.5,5,5,5.5,5,5,4.5,6,4,5.5,5,5,6,9,7,8,5,5.5,7.5,5,7,4.5,6,9.5,4.5,4.5,10.5,7,4.5,4,4.5,4,5,4.5,4.5,4.5,4.5,5,4.5,4.5,4.5,4.5,4,4,5,5.5,5.5,5,4.5,5,5,4.5,6,5.5,6,5.5,5,4.5,4.5,4.5,4.5,5.5,5.5,5.5,5,6,4.5,6,4,4.5,5,4.5,4,5,5,4.5,4.5,4.5,4.5,4,4.5,4.5,4,4,6,5,5,6,6.5,6.5,6.5,5,5,6.5,6,4.5,6.5,6.5,5.5,5.5,4.5,4.5,5.5,4.5,4,4.5,5.5,5,5,5.5,4,4,4.5,5,4.5,5.5,5,4,4,4,4,5.5,5,6.5,5.5,5.5,5,5.5,4.5,5,4.5,4.5,4.5,4.5,4.5,8.5,5,5,5.5,6,7],[5,4.1,4,4.4,4.8,5.4,4.6,5,4.4,5,4.5,4.8,4.3,5.2,4,4.9,6.7,11.3,5.2,7.7,4.7,5.1,4.2,5.1,4.7,4.9,7.5,4.7,4.2,4.9,5.6,4.5,8.4,5.3,5.3,4.5,3.9,4,4.2,4.2,4.4,4.4,5.4,5,4.5,4.6,4.3,5,4.3,5.9,5.9,7.5,5.5,5.2,4.3,5.2,4.8,5.8,5.8,4.5,5.5,4.5,4.5,4.4,6,5.9,4.2,4.3,6.3,4,3.9,4.5,3.9,4.3,4.2,4.8,4.5,4.3,4.3,4.4,4.5,3.9,4.6,4.5,6.2,5.8,4.7,5,4.9,5.5,5.4,5.5,4.4,4.1,5.3,4.5,4.9,5,4.5,4.5,4.5,4.5,5,4.8,4.8,5.8,5.2,5,5.5,5.5,4,4,5.3,4.4,4.3,4.3,4.7,4.4,3.9,4.4,3.8,3.9,3.9,4,4.2,5,5.3,5.4,5,4.9,5.7,4.4,4.5,4.4,5.7,6,6.6,4.8,4.5,4.5,4.5,4.6,4.7,5.3,4,5.8,5.6,4.7,5.3,4.7,4.7,4.7,5.1,5.9,5.6,4,4.7,5.3,4.9,7.9,8.3,7.3,5.7,4.3,8.3,4.5,6.7,9.2,7.1,4.3,4.8,4,4.5,4.5,4.4,4.4,4.3,4.1,5.4,3.8,3.8,4.2,4,4,4.5,4,5.2,4.3,4.8,5.5,5.6,7.1,5.3,4.7,4.4,4.3,5.8,4.5,5.7,5.5,4.4,5.6,5.3,4.3,4.8,4.3,4.5,4,4.9,6.2,5,4.3,5.5,4.8,3.9,4,5.1,4,4,4,4.8,6.8,5.7,5.3,5.9,5,5.2,4.3,5.2,7.7,5.1,4.5,4.5,4.5,6,7.5,7.7,5.7,4.5,5,3.9,4.3,4.3,4.5,4.1,4.2,4.1,4.2,4.5,4.3,4.3,4.4,4.3,4.2,4.3,4.5,4.5,4.3,5.9,4.7,4.7,5.2,5,4.7,5.3,4.6,4.6,4.8,4.4,4.4,4.5,4.7,4.5,4.5,4.5,5.3,5.5,5,4.1,4,4.8,4,4.3,3.8,4.4,5.5,4.4,4,3.8,3.8,4.3,4.4,4,4,4,5.7,5.2,4.8,5.6,4.9,5,4.6,4.7,4.2,4.8,4.3,4.3,5.6,4.5,4.4,6.6,5.7,4.5,4.5,4.5,5.4,4.3,4.4,4.5,5.6,5.9,3.9,4.3,5.3,4.8,4.1,5.8,5,4,4.4,5.2,4.3,5.2,6.4,6,5.1,7.2,4.6,6.6,4.8,4.2,5.7,4.4,4.4,4.5,4.5,4.5,10.2,6.2,4.9,4.2,6,4.5,4,4,4.9,5.4,6.2,7.3,7.8,5.2,3.8,4.2,4,5,4,5.3,5.3,5.4,6.4,6.3,11.8,5.4,12.9,5.1,5.2,4.4,4.3,6.9,5.5,4.5,4.5,4.5,9.1,5.1,4.5,6.1,4.4,4,3.9,5.4,4.9,6.1,5.1,5.9,5.8,5.4,6,5.5,4.7,5.9,4,4,5.5,11.8,8.1,10.9,7.4,6.1,4.4,5.3,7,4.5,4.4,4.5,4.5,10.3,9.1,4.2,4.9,5.3,5.2,4,4,4.9,4.8,4.8,5.5,5.5,4.1,4.8,4.8,4.3,5.8,4.8,4.2,3.9,5.3,4,5.8,4.7,7.6,5.3,11.3,4.8,9.6,4.9,6.2,7.3,4.4,4.4,6.6,5.2,5.4,4.4,4.5,4.5,6.1,8.6,8,4.9,4.8,4.3,3.9,4.7,4.5,4.3,4.2,4.4,4.2,4.2,4.8,4.3,3.9,4,4.9,5.3,4.9,5.2,4.6,4.8,5.2,5.6,4.6,4.5,4.8,4.9,5.6,4.5,5.1,5.9,5.7,4.8,6.5,4.3,4.3,4.6,4,4.6,5,4.9,4.2,4.7,4.7,4.3,4.3,4.2,3.9,3.9,4,4,5.6,4.5,4.8,4.7,4.9,4.1,5,4.5,4.5,4.4,4.5,4.2,5.5,5.2,5.6,5.8,4.4,4.5,4.5,4.4,4.3,4,4,5,4.6,4.7,4.7,4.7,4.7,3.9,4.3,4,4,5.8,6,4.5,6.4,5.5,5.9,5.4,4.3,4.3,5.4,4.3,4.5,4.4,4.5,4.5,4.5,4.5,5.1,8.4,5.7,4.6,4.5,5.6,4.3,4.2,4.7,5.4,5.2,4.6,4.5,5.2,4.7,4.9,4.3,5.6,3.9,5.5,4.9,4.7,5.7,9.6,6.4,7.4,4.9,5.1,7,4.7,6.9,4.4,5.9,9.2,4.4,4.5,11.9,6.9,4.5,3.9,4.6,4,4.6,4.3,4.4,4.1,4.4,4.8,4.5,4.2,4.3,4.4,3.9,4,4.7,5.2,5.1,4.6,4.5,4.6,4.8,4.3,5.6,5,5.4,5.5,4.9,4.5,4.5,4.5,4.5,5.2,5.2,5.1,4.8,5.6,4.5,6,3.9,4.3,5,4.5,4,4.7,5.7,4.2,4.3,4.1,4.3,3.9,4.8,4.5,4,4,6.6,4.5,4.9,5.5,6.4,6.1,5.8,4.7,5.2,5.8,5.9,4.5,6.7,6.1,5.5,5.5,4.5,4.3,5.3,4.4,4,4.4,5.4,4.9,4.9,5.4,3.9,3.8,4.1,4.7,4.4,5.1,5,4,3.9,3.9,4,5.1,4.6,6,5.1,5.3,4.9,5.5,4.3,4.7,4.4,4.5,4.4,4.4,4.5,8.1,4.8,4.7,5.2,5.9,6.8],[5.2,4.3,4,4.3,4.6,5.1,4.8,4.7,4.6,5.2,4.6,4.7,4.9,5.4,4.2,5.1,6,9.6,5.3,7.5,4.8,5.2,5.1,6,4.8,5.2,7.2,5.1,4.7,5,5.8,4.6,8.3,5.6,6.8,4.3,4.1,3.8,4.5,4.2,4.3,4.7,5.6,5.5,4.3,5,4.3,5,4.6,5.8,5.5,8.3,5.6,5.4,4.7,6.1,4.9,6,6.2,4.7,5.3,4.6,4.7,4.6,5.5,5.4,4.8,4.5,7.8,4,4,4.8,4,4.3,4.4,5.3,4.3,4.5,4.7,4.3,4.6,4.1,4.8,4.3,6,6,4.9,4.9,5.2,6.2,5.3,5.2,4.6,4.7,5.4,4.7,5.3,5,4.7,4.6,4.6,4.6,4.9,4.8,4.8,6.3,5.3,4.9,5.7,5.7,4,4.1,5.2,4.3,4.5,4.4,5.1,4.7,4,4.6,4.5,4,4,4.1,4.5,5,5.5,5.4,5.1,5,5.9,4.7,4.6,4.6,5.6,5.7,6.8,5.1,4.6,4.6,4.6,4.6,4.8,5.8,4,6,5.7,5.3,5.9,4.8,5,4.6,5.5,6.9,5.5,4,5.7,5.3,5,7.5,7.5,7.8,5.8,4.7,7.6,4.6,6.4,8.2,6.9,4.2,5,4,4.4,4.5,4.4,4.5,4.4,4.3,5.1,4,4.7,4.4,4.1,4,4.4,4,5.3,4.6,5,5.9,5.6,7.8,5.5,4.8,4.8,4.6,6.1,4.6,5.7,5.8,4.6,5.6,5.5,4.3,5.1,4.4,4.5,4,5.1,6.4,5.4,4.4,5.4,4.9,4,4.1,5.1,4,4,4,4.9,6.9,5.6,5.3,5.8,4.9,5.3,4.6,5.2,7.8,5.4,4.6,4.7,4.6,5.5,9.4,7.6,5.5,4.6,5.2,4,4.3,4.3,4.8,4.3,4.3,4.2,4.3,4.7,4.3,4.3,4.4,4.5,4.3,4.7,4.6,4.6,4.4,5.7,4.8,4.8,5.3,5.1,4.9,5.4,4.9,4.8,4.9,4.8,4.7,4.7,5.3,4.8,4.6,4.7,5.5,5.5,5.4,4.5,4,5.3,4,4.4,3.9,4.5,6.8,4.8,4.4,4.1,4.1,4.4,4.6,4.1,4.3,4,5.6,5.7,4.9,6.4,5,5.7,5,4.8,4.6,5,4.6,4.6,6.6,4.6,4.6,9,6,4.6,4.6,4.6,5.4,4.3,4.4,4.5,5.6,5.4,4.1,4.3,5,5.3,4.4,5.9,4.9,4,4.6,5.5,4.6,5.4,6.5,6,5.2,7.6,4.9,7.4,5.1,4.7,5.6,4.6,4.7,4.6,4.6,4.6,10.3,7.2,4.9,4.5,5.9,4.6,4,4,4.7,5.4,5.4,7.4,7.3,4.9,4.3,4.6,4.3,4.9,4,5.3,5.4,5.4,6,5.9,10.8,5.3,12.9,5.1,5.2,4.8,4.6,7.4,5.7,4.6,4.6,4.6,8.7,5.2,4.3,6.3,4.4,4,4.4,5.3,4.6,5.9,6.2,5.8,6.6,5.1,5.6,5.3,4.6,6.8,4,4,7.4,10.9,8.6,10.4,7,7.4,4.6,5.4,7,4.6,4.6,4.6,4.6,8.5,8.5,4.6,4.6,5.3,5.1,4,4,4.6,4.6,4.6,5.6,6.1,4.3,5,4.8,4.3,6.3,4.6,4.4,4,5.2,4.1,5.8,5,7.3,5.3,12.4,4.9,9.6,5.2,6,7.4,4.6,4.6,6.2,5.1,5.3,4.6,4.9,4.7,5.7,7.8,7.9,4.9,4.9,4.3,4,4.7,4.4,4.3,4.4,4.5,4.4,4.5,4.7,4.4,4,4.3,5.5,5.3,5.1,5.1,4.8,4.9,5.4,5.8,4.9,5.1,5,5.2,5.6,4.7,5.3,5.6,5.7,4.8,7.4,4.3,4.3,4.7,4,4.5,4.8,4.8,4.5,4.4,4.7,4.3,4.5,4.3,4,4.1,4.1,4,5.6,4.8,5,5,5,4.8,4.9,4.7,4.6,4.6,4.7,4.9,5.6,5.6,5.6,5.5,4.6,4.8,4.6,4.6,4.3,4.5,4,4.8,4.7,4.9,4.7,4.8,4.7,4.1,4.3,3.9,4,5.9,6,4.8,6.1,5.7,7,5.2,4.6,4.7,5.4,4.7,4.7,4.6,4.6,4.6,4.6,4.6,5.2,8.1,6.4,4.8,4.7,5.7,4.3,4.2,4.6,5.3,5.4,4.9,4.8,5.1,4.6,4.8,4.3,5.2,4,5.6,4.8,4.9,5.6,11.3,6.5,6.8,5.1,5.2,6.6,4.8,6.3,4.6,6,9.1,4.6,4.6,12.7,6.1,4.6,4.1,4.8,4,4.8,4.2,4.5,4.6,4.5,4.5,4.4,4.2,4.3,4.4,4,4,4.9,5.3,5.4,4.9,4.6,4.9,4.9,4.6,5.5,5.2,6.4,5.4,5,4.7,4.6,4.6,4.6,5.6,5.3,5.1,4.8,5.6,4.6,5.9,4,4.5,5.2,4.3,4,5,6.5,4.4,4.6,4.5,4.4,4.2,5.3,4.7,4.1,4,7.8,4.9,4.9,5.5,6,5.8,6.6,5,6.2,6.3,5.9,4.6,7.3,6,5.1,5.1,4.6,4.4,5.4,4.3,4,4.3,5.2,5,5.5,5.1,4.1,4.6,4.2,4.7,4.4,5.4,4.9,4.1,4,4,4.1,5.2,5,5.9,5.5,5.7,5,6.3,4.6,5,4.6,4.7,4.6,4.6,4.6,7.3,4.8,4.8,5.5,5.5,6.3],[0.2,0.2,0,-0.1,-0.2,-0.3,0.2,-0.3,0.2,0.2,0.1,-0.1,0.6,0.2,0.2,0.2,-0.7,-1.7,0.1,-0.2,0.1,0.1,0.9,0.9,0.1,0.3,-0.3,0.4,0.5,0.1,0.2,0.1,-0.1,0.3,1.5,-0.2,0.2,-0.2,0.3,0,-0.1,0.3,0.2,0.5,-0.2,0.4,0,-0,0.3,-0.1,-0.4,0.8,0.1,0.2,0.4,0.9,0.1,0.2,0.4,0.2,-0.2,0.1,0.2,0.2,-0.5,-0.5,0.6,0.2,1.5,-0,0.1,0.3,0.1,0,0.2,0.5,-0.2,0.2,0.4,-0.1,0.1,0.2,0.2,-0.2,-0.2,0.2,0.2,-0.1,0.3,0.7,-0.1,-0.3,0.2,0.6,0.1,0.2,0.4,0,0.2,0.1,0.1,0.1,-0.1,0,0,0.5,0.1,-0.1,0.2,0.2,0,0.1,-0.1,-0.1,0.2,0.1,0.4,0.3,0.1,0.2,0.7,0.1,0.1,0.1,0.3,-0,0.2,-0,0.1,0.1,0.2,0.3,0.1,0.2,-0.1,-0.3,0.2,0.3,0.1,0.1,0.1,-0,0.1,0.5,0,0.2,0.1,0.6,0.6,0.1,0.3,-0.1,0.4,1,-0.1,0,1,0,0.1,-0.4,-0.8,0.5,0.1,0.4,-0.7,0.1,-0.3,-1,-0.2,-0.1,0.2,0,-0.1,-0,-0,0.1,0.1,0.2,-0.3,0.2,0.9,0.2,0.1,0,-0.1,0,0.1,0.3,0.2,0.4,-0,0.7,0.2,0.1,0.4,0.3,0.3,0.1,-0,0.3,0.2,-0,0.2,-0,0.3,0.1,0,-0,0.2,0.2,0.4,0.1,-0.1,0.1,0.1,0.1,-0,0,0,0,0.1,0.1,-0.1,-0,-0.1,-0.1,0.1,0.3,0,0.1,0.3,0.1,0.2,0.1,-0.5,1.9,-0.1,-0.2,0.1,0.2,0.1,-0,-0,0.3,0.2,0.1,0.1,0.1,0.2,0,0,-0,0.2,0.1,0.4,0.1,0.1,0.1,-0.2,0.1,0.1,0.1,0.1,0.2,0.1,0.3,0.2,0.1,0.4,0.3,0.2,0.6,0.3,0.1,0.2,0.2,-0,0.4,0.4,-0,0.5,-0,0.1,0.1,0.1,1.3,0.4,0.4,0.3,0.3,0.1,0.2,0.1,0.3,0,-0.1,0.5,0.1,0.8,0.1,0.7,0.4,0.1,0.4,0.2,0.3,0.3,1,0.1,0.2,2.4,0.3,0.1,0.1,0.1,-0,-0,-0,0,-0,-0.5,0.2,0,-0.3,0.5,0.3,0.1,-0.1,0,0.2,0.3,0.3,0.2,0.1,-0,0.1,0.4,0.3,0.8,0.3,0.5,-0.1,0.2,0.3,0.1,0.1,0.1,0.1,1,0,0.3,-0.1,0.1,-0,-0,-0.2,-0,-0.8,0.1,-0.5,-0.3,0.5,0.4,0.3,-0.1,0,0,0.1,-0,-0.4,-0.4,-1,-0.1,-0,0,0,0.4,0.3,0.5,0.2,0.1,0.1,0.1,-0.4,0.1,-0.2,0.2,-0,-0,0.5,-0.1,-0.3,-0.2,1.1,-0.1,0.8,-0.3,-0.4,-0.2,-0.1,0.9,0,0,1.9,-0.9,0.5,-0.5,-0.4,1.3,0.2,0.1,-0,0.1,0.2,0.1,0.1,-1.8,-0.6,0.4,-0.3,-0,-0.1,-0,-0,-0.3,-0.2,-0.2,0.1,0.6,0.2,0.2,-0,0,0.5,-0.2,0.2,0.1,-0.1,0.1,-0,0.3,-0.3,0,1.1,0.1,-0,0.3,-0.2,0.1,0.2,0.2,-0.4,-0.1,-0.1,0.2,0.4,0.2,-0.4,-0.8,-0.1,0,0.1,-0,0.1,-0,-0.1,0,0.2,0.1,0.2,0.3,-0.1,0.1,0.1,0.3,0.6,0,0.2,-0.1,0.2,0.1,0.2,0.2,0.3,0.6,0.2,0.3,0,0.2,0.2,-0.3,0,0,0.9,-0,-0,0.1,0,-0.1,-0.2,-0.1,0.3,-0.3,-0,-0,0.2,0.1,0.1,0.2,0.1,0,-0,0.3,0.2,0.3,0.1,0.7,-0.1,0.2,0.1,0.2,0.2,0.7,0.1,0.4,-0,-0.3,0.2,0.3,0.1,0.2,-0,0.5,-0,-0.2,0.1,0.2,0,0.1,-0,0.2,0,-0.1,0,0.1,0,0.3,-0.3,0.2,1.1,-0.2,0.3,0.4,-0,0.4,0.2,0.2,0.1,0.1,0.1,0.1,0.1,-0.3,0.7,0.2,0.2,0.1,-0,0,-0.1,-0.1,0.2,0.3,0.3,-0.1,-0.1,-0.1,0,-0.4,0.1,0.1,-0.1,0.2,-0.1,1.7,0.1,-0.6,0.2,0.1,-0.4,0.1,-0.6,0.2,0.1,-0.1,0.2,0.1,0.8,-0.8,0.1,0.2,0.2,-0,0.2,-0.1,0.1,0.5,0.1,-0.3,-0.1,0,0,-0,0.1,0,0.2,0.1,0.3,0.3,0.1,0.3,0.1,0.3,-0.1,0.2,1,-0.1,0.1,0.2,0.1,0.1,0.1,0.4,0.1,0,0,-0,0.1,-0.1,0.1,0.2,0.2,-0.2,-0,0.3,0.8,0.2,0.3,0.4,0.1,0.3,0.5,0.2,0.1,0,1.2,0.4,-0,0,-0.4,-0.3,0.8,0.3,1,0.5,-0,0.1,0.6,-0.1,-0.4,-0.4,0.1,0.1,0.1,-0.1,-0,-0.1,-0.2,0.1,0.6,-0.3,0.2,0.8,0.1,-0,-0,0.3,-0.1,0.1,0.1,0.1,0.1,0.1,0.4,-0.1,0.4,0.4,0.1,0.8,0.3,0.3,0.2,0.2,0.2,0.2,0.1,-0.8,0,0.1,0.3,-0.4,-0.5],[4.6,3.6,3.4,3.7,4,4.4,4.1,4.1,3.9,4.6,4,4.1,4.2,4.7,3.6,4.5,5.3,8.9,4.6,6.9,4.2,4.5,4.4,5.3,4.2,4.5,6.5,4.4,4.1,4.4,5.1,3.9,7.6,5,6.1,3.6,3.4,3.2,3.8,3.6,3.7,4,5,4.8,3.7,4.4,3.7,4.3,3.9,5.2,4.8,7.6,5,4.8,4.1,5.5,4.3,5.3,5.6,4.1,4.6,3.9,4,4,4.9,4.8,4.2,3.9,7.1,3.3,3.4,4.1,3.3,3.7,3.8,4.6,3.7,3.8,4,3.7,3.9,3.4,4.1,3.7,5.3,5.4,4.3,4.2,4.6,5.5,4.6,4.6,4,4.1,4.7,4,4.6,4.4,4,3.9,3.9,3.9,4.2,4.2,4.2,5.7,4.7,4.3,5.1,5,3.4,3.4,4.6,3.7,3.9,3.7,4.5,4,3.4,3.9,3.8,3.4,3.4,3.4,3.9,4.3,4.8,4.7,4.5,4.3,5.2,4,3.9,3.9,5,5.1,6.1,4.5,3.9,4,4,3.9,4.1,5.2,3.4,5.4,5,4.7,5.2,4.2,4.3,3.9,4.9,6.2,4.9,3.4,5,4.7,4.4,6.8,6.8,7.1,5.2,4,6.9,3.9,5.8,7.5,6.2,3.6,4.4,3.4,3.7,3.8,3.7,3.8,3.8,3.7,4.5,3.4,4,3.8,3.4,3.4,3.8,3.4,4.7,4,4.3,5.2,4.9,7.1,4.8,4.2,4.1,3.9,5.5,3.9,5,5.1,3.9,4.9,4.9,3.6,4.4,3.7,3.9,3.3,4.5,5.8,4.8,3.7,4.7,4.3,3.4,3.5,4.4,3.4,3.4,3.4,4.3,6.3,4.9,4.6,5.1,4.3,4.7,4,4.6,7.1,4.7,3.9,4,3.9,4.8,8.6,7,4.8,3.9,4.5,3.4,3.6,3.6,4.1,3.7,3.7,3.6,3.6,4,3.7,3.7,3.7,3.8,3.6,4,3.9,3.9,3.8,5.1,4.2,4.2,4.7,4.5,4.3,4.8,4.3,4.2,4.2,4.1,4,4.1,4.6,4.1,3.9,4,4.8,4.8,4.7,3.9,3.3,4.6,3.3,3.7,3.2,3.8,6.1,4.2,3.8,3.5,3.4,3.8,3.9,3.4,3.6,3.4,5,5.1,4.2,5.8,4.3,5,4.3,4.2,4,4.3,3.9,3.9,5.9,3.9,3.9,8.3,5.3,4,3.9,3.9,4.7,3.6,3.7,3.9,4.9,4.7,3.5,3.7,4.3,4.6,3.7,5.2,4.2,3.4,3.9,4.8,3.9,4.8,5.9,5.3,4.5,6.9,4.3,6.7,4.4,4.1,4.9,4,4,3.9,3.9,3.9,9.7,6.5,4.2,3.8,5.3,3.9,3.3,3.3,4,4.7,4.7,6.8,6.7,4.2,3.6,4,3.6,4.2,3.4,4.7,4.8,4.7,5.3,5.3,10.1,4.7,12.2,4.5,4.6,4.1,3.9,6.7,5,3.9,3.9,3.9,8,4.5,3.6,5.7,3.7,3.3,3.8,4.7,4,5.3,5.5,5.1,5.9,4.5,5,4.7,4,6.1,3.4,3.4,6.7,10.2,8,9.7,6.3,6.7,3.9,4.8,6.3,3.9,3.9,3.9,3.9,7.9,7.9,4,3.9,4.6,4.5,3.3,3.3,4,4,4,4.9,5.4,3.7,4.4,4.1,3.7,5.7,4,3.7,3.4,4.5,3.5,5.1,4.3,6.7,4.7,11.7,4.2,8.9,4.6,5.4,6.8,3.9,3.9,5.6,4.5,4.7,4,4.3,4,5.1,7.1,7.3,4.3,4.2,3.6,3.3,4,3.8,3.7,3.7,3.8,3.8,3.8,4,3.8,3.4,3.7,4.8,4.7,4.5,4.5,4.2,4.2,4.7,5.2,4.3,4.4,4.3,4.5,5,4,4.7,5,5.1,4.2,6.7,3.6,3.6,4.1,3.3,3.9,4.1,4.2,3.8,3.7,4,3.6,3.8,3.7,3.4,3.5,3.4,3.4,4.9,4.2,4.3,4.3,4.3,4.1,4.2,4,3.9,3.9,4,4.2,5,4.9,4.9,4.9,4,4.1,3.9,3.9,3.6,3.9,3.3,4.2,4,4.3,4.1,4.2,4,3.4,3.7,3.2,3.4,5.3,5.4,4.1,5.4,5,6.3,4.5,3.9,4,4.7,4.1,4,3.9,3.9,4,3.9,3.9,4.5,7.5,5.8,4.2,4,5.1,3.6,3.6,3.9,4.7,4.7,4.3,4.1,4.4,3.9,4.1,3.7,4.5,3.4,5,4.1,4.3,4.9,10.6,5.9,6.1,4.5,4.5,6,4.2,5.6,3.9,5.3,8.4,3.9,3.9,12,5.5,4,3.5,4.2,3.3,4.2,3.6,3.8,4,3.9,3.9,3.8,3.6,3.7,3.7,3.4,3.4,4.2,4.7,4.7,4.2,3.9,4.2,4.3,4,4.8,4.6,5.8,4.7,4.3,4,3.9,3.9,3.9,4.9,4.6,4.5,4.2,4.9,3.9,5.2,3.4,3.8,4.5,3.6,3.3,4.4,5.9,3.8,3.9,3.8,3.8,3.6,4.6,4,3.4,3.4,7.1,4.2,4.2,4.9,5.3,5.1,5.9,4.3,5.5,5.7,5.2,3.9,6.6,5.3,4.5,4.5,3.9,3.7,4.7,3.6,3.3,3.7,4.6,4.3,4.8,4.4,3.5,4,3.5,4,3.7,4.7,4.2,3.4,3.4,3.4,3.4,4.6,4.3,5.3,4.8,5.1,4.4,5.6,3.9,4.3,3.9,4,4,3.9,3.9,6.6,4.2,4.2,4.8,4.8,5.6],[5.9,4.9,4.7,5,5.3,5.7,5.4,5.4,5.2,5.9,5.3,5.4,5.5,6,4.9,5.8,6.7,10.3,5.9,8.2,5.5,5.8,5.7,6.6,5.5,5.8,7.8,5.7,5.4,5.7,6.4,5.2,8.9,6.3,7.4,4.9,4.7,4.5,5.1,4.9,5,5.3,6.3,6.1,5,5.7,5,5.6,5.2,6.5,6.1,8.9,6.3,6.1,5.4,6.8,5.6,6.6,6.9,5.4,5.9,5.2,5.3,5.3,6.2,6.1,5.5,5.2,8.4,4.6,4.7,5.4,4.6,5,5.1,5.9,5,5.1,5.3,5,5.2,4.7,5.5,5,6.6,6.7,5.6,5.5,5.9,6.8,5.9,5.9,5.3,5.4,6,5.3,5.9,5.7,5.3,5.2,5.2,5.2,5.5,5.5,5.5,7,6,5.6,6.4,6.3,4.7,4.7,5.9,5,5.2,5,5.8,5.3,4.7,5.2,5.1,4.7,4.7,4.7,5.2,5.6,6.1,6,5.7,5.6,6.5,5.3,5.2,5.2,6.3,6.4,7.4,5.8,5.2,5.3,5.3,5.2,5.4,6.5,4.7,6.7,6.3,6,6.5,5.5,5.6,5.2,6.2,7.6,6.2,4.7,6.3,6,5.7,8.2,8.1,8.4,6.5,5.3,8.3,5.2,7.1,8.9,7.5,4.9,5.7,4.7,5.1,5.1,5,5.1,5.1,5,5.8,4.7,5.3,5.1,4.7,4.7,5.1,4.7,6,5.3,5.6,6.5,6.2,8.4,6.1,5.5,5.4,5.2,6.8,5.2,6.3,6.4,5.2,6.2,6.2,4.9,5.7,5,5.2,4.6,5.8,7.1,6.1,5,6,5.6,4.7,4.8,5.7,4.7,4.7,4.7,5.6,7.6,6.2,5.9,6.4,5.6,5.9,5.3,5.9,8.5,6,5.2,5.3,5.2,6.2,10.1,8.3,6.1,5.2,5.8,4.7,4.9,4.9,5.4,5,5,4.9,5,5.3,5,5,5,5.1,4.9,5.3,5.2,5.2,5.1,6.4,5.5,5.5,6,5.8,5.6,6.1,5.6,5.5,5.5,5.4,5.3,5.4,5.9,5.4,5.2,5.3,6.1,6.1,6,5.2,4.6,6,4.7,5,4.5,5.1,7.4,5.5,5.1,4.8,4.7,5.1,5.2,4.7,5,4.7,6.3,6.4,5.5,7.1,5.6,6.3,5.6,5.5,5.3,5.6,5.2,5.2,7.2,5.2,5.2,9.7,6.6,5.3,5.2,5.2,6,4.9,5,5.2,6.2,6,4.8,5,5.6,6,5,6.5,5.5,4.7,5.2,6.1,5.2,6,7.2,6.6,5.8,8.3,5.6,8,5.7,5.4,6.2,5.3,5.3,5.2,5.2,5.2,11,7.9,5.6,5.1,6.6,5.3,4.6,4.6,5.3,6,6.1,8.1,8,5.5,4.9,5.3,4.9,5.5,4.7,6,6.1,6,6.6,6.6,11.4,6,13.5,5.8,5.9,5.4,5.2,8.1,6.3,5.2,5.2,5.2,9.3,5.8,4.9,7,5,4.6,5.1,6,5.3,6.6,6.8,6.4,7.2,5.8,6.3,6,5.3,7.4,4.7,4.7,8,11.6,9.3,11.1,7.6,8,5.2,6.1,7.6,5.2,5.2,5.2,5.2,9.2,9.2,5.3,5.2,5.9,5.8,4.6,4.6,5.3,5.3,5.3,6.2,6.7,5,5.7,5.4,5,7,5.3,5,4.7,5.8,4.8,6.4,5.6,8,6,13.1,5.5,10.2,5.9,6.7,8.1,5.2,5.2,6.9,5.8,6,5.3,5.6,5.3,6.4,8.5,8.6,5.6,5.5,4.9,4.6,5.3,5.1,5,5,5.1,5.1,5.1,5.3,5.1,4.7,5,6.2,6,5.8,5.8,5.5,5.5,6,6.5,5.6,5.7,5.6,5.8,6.3,5.3,6,6.3,6.4,5.5,8,4.9,4.9,5.4,4.7,5.2,5.5,5.5,5.1,5,5.3,4.9,5.1,5,4.7,4.8,4.7,4.7,6.2,5.5,5.6,5.6,5.6,5.4,5.5,5.3,5.2,5.2,5.3,5.5,6.3,6.2,6.2,6.2,5.3,5.4,5.2,5.3,4.9,5.2,4.6,5.5,5.3,5.6,5.4,5.5,5.3,4.7,5,4.5,4.7,6.6,6.7,5.4,6.7,6.3,7.6,5.8,5.2,5.3,6,5.4,5.3,5.2,5.2,5.3,5.2,5.2,5.8,8.8,7.1,5.5,5.3,6.4,4.9,4.9,5.2,6,6,5.6,5.4,5.7,5.2,5.4,5,5.8,4.7,6.3,5.4,5.6,6.2,12,7.2,7.4,5.8,5.8,7.3,5.5,6.9,5.2,6.6,9.7,5.2,5.2,13.4,6.8,5.3,4.8,5.5,4.6,5.5,4.9,5.1,5.3,5.2,5.2,5.1,4.9,5,5,4.7,4.7,5.5,6,6,5.5,5.2,5.5,5.6,5.3,6.1,5.9,7.1,6,5.6,5.3,5.2,5.2,5.2,6.2,5.9,5.8,5.5,6.2,5.2,6.5,4.7,5.1,5.8,4.9,4.6,5.7,7.2,5.1,5.2,5.1,5.1,4.9,5.9,5.3,4.7,4.7,8.5,5.5,5.5,6.2,6.6,6.4,7.2,5.6,6.9,7,6.5,5.2,7.9,6.6,5.8,5.8,5.2,5,6,4.9,4.7,5,5.9,5.6,6.2,5.7,4.8,5.3,4.8,5.3,5,6,5.5,4.7,4.7,4.7,4.7,5.9,5.6,6.6,6.1,6.4,5.7,6.9,5.2,5.6,5.2,5.3,5.3,5.2,5.2,7.9,5.5,5.5,6.1,6.1,6.9]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Name<\/th>\n      <th>Position<\/th>\n      <th>Team<\/th>\n      <th>Minutes Played<\/th>\n      <th>Total Points<\/th>\n      <th>Start Cost (2020/21)<\/th>\n      <th>Final Cost (2020/21)<\/th>\n      <th>Predicted Start Cost (2021/22)<\/th>\n      <th>Price Change<\/th>\n      <th>Predicted Lower Bound<\/th>\n      <th>Predicted Higher Bound<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[4,5,6,7,8,9,10,11]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true}},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>FPL2021_prices %&gt;% 
  group_by(team) %&gt;% 
  mutate( web_name = fct_reorder(web_name,as.numeric(element_type),.fun = mean )) %&gt;% 
  mutate( web_name = tidytext::reorder_within(web_name,as.numeric(element_type),team )) %&gt;% 
  slice_max(order_by = minutes,n=15) %&gt;% 
  ggplot(aes(col=element_type))+
  geom_errorbarh(aes(y=web_name,xmin=.pred_lower,xmax=.pred_upper )) +
  geom_point((aes(x=.pred,y=web_name)))+
  facet_wrap(.~team,scales=&quot;free_y&quot;)+
  tidytext::scale_y_reordered()+
  scale_x_continuous(breaks = seq(0,13.5,2))+
  scale_color_brewer(palette=&quot;Set1&quot;)+
  labs(title=&quot;Predicted starting prices for players&quot;,
       subtitle = &quot;95% prediction interval for top 15 players in team by minutes played&quot;,
       x=&quot;Predicted Price (£m)&quot;,y=&quot;&quot;,col=&quot;Position&quot;)+
  theme_bw()+
  theme(plot.title.position = &quot;plot&quot;,
        legend.position = &quot;top&quot;,
        panel.grid.major.y = element_blank(),
        panel.grid.major.x = element_line(colour = &quot;grey80&quot;))</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-19-1.png" width="960" /></p>
<div id="out-of-position-players" class="section level2">
<h2>Out of position players</h2>
<p>One of the limitations of the model is that it doesn’t predict or taken into account a potential change in player position. This is due to the powers that be at FPL, whom can change what a player’s designated position is from season to season. The model does not consider a change in player position, which could over or underestimate a player’s price depending on the previous and new positions.</p>
<p>One such player is Stuart Dallas from Leeds. During the 2020/21 season, he was designated as a DEF in FPL but during the live matches he played more of a midfielder role, and scored many attacking points like assists or goals. This lead to him obtaining points from attacking returns and also cleansheets as defenders get more points for cleansheets than midfielders do. It is extremely likely that he will be designated as a MID for the 2021/22 season. Let’s see what his new price prediction is.</p>
<pre class="r"><code>dallas &lt;-  clean_2020 %&gt;% 
  filter( full_name == &quot;stuart dallas&quot;)

dallas_def &lt;-  dallas %&gt;% bind_cols(full_model %&gt;% predict(new_data=dallas),
                                    full_model %&gt;% predict(new_data=dallas,type=&quot;pred_int&quot;)) %&gt;% 
  select(full_name,.pred,.pred_lower,.pred_upper) %&gt;% 
  mutate(&quot;position&quot;=&quot;DEF&quot;)

# Change Dallas from DEF to MID
dallas$element_type &lt;- &quot;MID&quot;

dallas_mid &lt;- dallas %&gt;% bind_cols(full_model %&gt;% predict(new_data=dallas),
                                   full_model %&gt;% predict(new_data=dallas,type=&quot;pred_int&quot;)) %&gt;% 
  select(full_name,.pred,.pred_lower,.pred_upper)%&gt;% 
  mutate(&quot;position&quot;=&quot;MID&quot;)


bind_rows(dallas_def,dallas_mid ) %&gt;% 
  mutate( across( .cols =  .pred:.pred_upper, .fns =  function(.x) round(.x,1)     )   ) %&gt;% 
  ggplot()+
  geom_errorbar(aes(ymin=.pred_lower,ymax=.pred_upper,x=position),width=.2 )+
  geom_point((aes(y=.pred,x=position)))+
  scale_y_continuous(labels =  scales::label_dollar(prefix = &quot;£&quot;,suffix = &quot;m&quot;),limits = c(6,8,.5))+
  labs(title=&quot;Stuart Dallas is likely to be priced higher as a midfielder than a defender&quot;,
       subtitle = &quot;Predicted starting price with 95% prediction interval&quot;,
       x=&quot;Position&quot;,y=&quot;Predicted Price (£m)&quot;)+
  theme_light()+
  theme(plot.title.position = &quot;plot&quot;,
        panel.grid.major.x = element_blank()
        )</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<p>We could also have gotten this by noting that the different between the regression coefficients of <code>element_type_MID</code> and <code>element_type_DEF</code>. The difference is <span class="math inline">\(0.31 - 0.06 = 0.25\)</span>. Thus Dallas would be £0.25m more expensive as a midfielder than defender.</p>
<p>We can also work out how much more expensive/cheaper a player would be if a position was changed. Based on the regression coefficients for <code>element_type_x</code>, we get</p>
<ul>
<li>From DEF to MID, a price increase of £0.25m</li>
<li>From MID to FWD, a price decrease of £0.03m</li>
</ul>
<p>To get the reverse of these simply change the sign i.e. FWD to MID would be price increase of £0.03m and MID to DEF would be price decrease of £0.25m.</p>
</div>
</div>
<div id="limitations-of-the-model" class="section level1">
<h1>Limitations of the model</h1>
<p>What does the model not do well with? Well we have seen that the model does not take into account a change in players position, and earlier it was noticed that it doesn’t do well with expensive defenders or goalkeepers.</p>
<p>The rmse is also highest for forwards, out of all the other positions. Creating a model that takes into account goals and assists may be beneficial. We could include features like a player’s “percent of goals scored by team”. This way if a player doesn’t score many goals compared to their other counterparts, but scores a proportion of goals for a team then could that player be classed as a talisman and hence have a higher price? Further research would be needed.</p>
<p>Another thing it is unable to predict is the price of players from newly promoted teams. Creating another model would be needed here since our current model uses information like the number of transfers and FPL points to predict next season’s starting price.</p>
<p>The model also does not take into account player team transfers. At the end of a season players are able to be move to another club depending on the terms of their contract. A player moving up to a “higher tier” club may be priced differently than if he were to remain at the same club or even “lower tier”. This is because a move may mean the player has the potential to play more or less minutes depending on the team, it is also true that the quality of the team will also be different, so a player with a potential to be in a “high tier” club may be surrounded by good players who can return more points, but being in a strong team.</p>
<p>An additional consideration maybe important events like European trophy campaigns and national team evens like the European Championships or the World Cup. It is possible that players who performed well at these events may get a price increase, but we would actually need to look at the data to see if there’s anything of significance here.</p>
</div>
<div id="conclusion" class="section level1">
<h1>Conclusion</h1>
<p>We have attempted to predict the next season’s price given data about the current season and we have managed to get an error rate of about 0.33 using rmse. The linear regression works very well considering it is a very simple model, but this goes to show that even something simple can do the job!</p>
<p>I may do another blogpost on this matter when the next season’s prices are actually released and we can compare how our model performed against reality.</p>
</div>
